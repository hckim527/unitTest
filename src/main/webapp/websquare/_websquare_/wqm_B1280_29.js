"use strict";(self.webpackChunkwebpack_test=self.webpackChunkwebpack_test||[]).push([[29],{29:(e,t,s)=>{s.r(t),s.d(t,{autoComplete:()=>u});var r=s(1570),o=s(8548),n=s(866),l=s(2847),a=s(6323),h=s(3885),d=s(4302),p=s(5217),u=function(e,t,i){h.q.call(this,e,t,i)};r.q.extend(u.prototype,h.q.prototype),r.q.extend(u.prototype,d.t.prototype),r.q.extend(u.prototype,p.G.prototype),u.prototype.defaultOptions={pluginType:"uiplugin.autoComplete",pluginName:"autoComplete",renderType:"component",userEvents:["onchange","oneditend","onviewchange","oneditkeyup","oneditenter","onselected","onbeforeselect","oninputfocus"],useConfig:!0,serializable:!0,useOtherComponentId:"",value:"",chooseOption:!1,chooseOptionLabel:"",chooseOptionValue:"",allOption:!1,sortOption:"",sortMethod:"",wmode:!1,visibleRowNum:5,displayMode:"0",displayModeSync:!1,delimiter:"\t",defaultStyle:"",activeStyle:"",textAlign:"",defaultClass:"w2inputSelectDefault",activeClass:"w2inputSelectActive",useLocale:!1,submenuSize:"fixed",direction:"auto",dynamicDraw:!0,tooltipDisplay:!1,tooltipClass:"",itemTooltipDisplay:!1,itemTooltipFormatter:"",tooltipTime:1,editable:!0,search:"start",editmode:!1,dataurl:"",interactionMode:!1,interactionKey:"default",interactionEnterKey:!1,submission:"",submissionFunc:"",keyInputRef:"",readOnly:!1,mandatory:!1,maxlength:-1,minlength:-1,allowChar:"",ignoreChar:"",characterCase:"",maxByteLength:-1,minByteLength:-1,validator:"",invalidMessage:"",invalidMessageFunc:"",displaymessage:!1,interactionMinByteLength:0,title:"",noResult:"previous",noResultFirstItem:!1,ignoreBlankOnNoResult:!1,escape:!0,displayFormatter:"",useMousewheel:!0,editModeEvent:"onclick",showItemTableByFocus:!1,allowEmptySubmission:"false",searchTarget:"label",caseSensitive:!0,editType:"select",useKeywordHighlight:!1,returnValueType:"null",emptyItem:!1,emptyValue:"",emptyIndex:0,closeonmouseleave:!1,handleOtherClick:!0,animation:"",selectedData:!0,preventWheelEvent:!1,customLabelFormatter:"",disableEdit:!1,type:"text",wheelRows:0,visibleColumn:"",visibleColumnFalseValue:"0,false,FALSE,F",enableColumn:"",enableColumnFalseValue:"0,false,FALSE,F",autocomplete:"off",placeholder:"",autoFocus:!1,noUseAutoFind:!1,findItemFirstKey:!1,nextTabByEnter:!1,customToggleKey:"",selectByTabKey:!1,preventKeyList:"",useFindItemFirstKeyChar:!0,setNodeSetNoOnchange:!1,hideListOnFocus:!1,itemEnterHandleMode:"arrow",useLocale:!1,placeholderLocaleRef:"",accessibility:!1,appearance:"",removeLabelFor:!1,labelForText:"",setInitOnchangeSkip:!1,valueNotInList:"default",blurEventControl:!1},u.prototype.initialize=function(e){try{if(this._setSetting=!1,this.itemTable=null,this.gridOptions={},this.gridViewOptions={},this.isOpen=!1,this.statusSubLayer=!1,this._itemTableRedraw=!0,this.supportAutocomplete=!1,!0===this.options.accessibility&&(this.options.renderType="input"),this.options.emptyItem?(this.options.noResult="clear",this.noResult="clear"):this.noResult="previous"===this.options.noResult||"clear"===this.options.noResult||"noEnd"===this.options.noResult||"useData"===this.options.noResult||"first"===this.options.noResult?this.options.noResult:"previous",this.options.tooltip&&this.options.tooltipDisplay&&(this.options.tooltip=""),this.editable=this.options.editable,this.search=this.options.search,this.orgSearchArr=[],this.selectedItem={text:"",value:"",orgLabel:""},this.selectedGridRowObj={},this.selectedGridViewRowObj={},this.viewArr=[],this.itemArr=[],this.dummyItemArr=[],this.dummyGridItemArr=[],this.mytime=null,this.hideTime=null,this.tooltip=null,this.timeShowTooltip=null,this.timeHideTooltip=null,this.editmode=this.options.editmode,this.findkeymode=!1,this.mozTrickBuffer="",this.trickBuffer="",this.findStop=!1,this.skipMatch=!1,this.defaultAllOptionLabel=WebSquare.language.getMessage("AutoComplete_all"),e&&"$blank"==e.getAttribute("chooseOptionLabel")?this.defaultChooseOptionLabel="":this.defaultChooseOptionLabel=WebSquare.language.getMessage("AutoComplete_choose"),this._initDisplayMode(),
this.dataurl=this.options.dataurl,this.selectedIndex=-1,this.selectedAllIndex=-1,this.cursorIndex=-1,this.showRowIndex=0,this.displayCount=0,!this.options.interactionMode||this.options.submission||this.options.submissionFunc||(this.options.interactionMode=!1),this._showItemTableByFocus=!1,"onfocus"===this.options.editModeEvent&&this.options.showItemTableByFocus&&(this._showItemTableByFocus=!0),this.interactionMode=this.options.interactionMode,e){var t=WebSquare.Elem.api.getElementsByTagName(e,"choices",o.I._XML_NAMESPACE.W2)[0];if(t){var i=WebSquare.Elem.api.getElementsByTagName(t,"gridItemset",o.I._XML_NAMESPACE.W2)[0];null==i&&(i=WebSquare.Elem.api.getElementsByTagName(t,"gridViewItemset",o.I._XML_NAMESPACE.W2)[0]),i&&"w2:gridItemset"==i.getTagName()?this.itemTableMode="grid":i&&"w2:gridViewItemset"==i.getTagName()&&(this.itemTableMode="gridView")}else"gridViewItemset"==this.options.itemTableType&&(this.itemTableMode="gridView");if("grid"==this.itemTableMode?this.initializeGridItemArr(e):"gridView"==this.itemTableMode?this.initializeGridViewItemArr(e):this.initializeItemArr(e),this.autoFinder="w2:autoFinder"==e.getTagName(),this.autoFinder){if(this.display_path=this.options.display_path,void 0!==this.display_path){this.display_path=this.display_path.replace(/^\s\s*/,"").replace(/\s\s*$/,"");var s=this.display_path.split(" "),r=s[0],l=s[1],h=s[2];this.setItemSet(r,l,h),this.buildItemArr()}}else"grid"!=this.itemTableMode&&"gridView"!=this.itemTableMode&&(this.itemsetObj=WebSquare.WebSquareparser.parseItemset(e))}if(this.validator=new WebSquare.validator.validateInvoker(this.id,this.options),this.displayFormatter=null,this.onchangeFlag=!1,this.otherClicked=!1,this.options.autocomplete&&WebSquare.uiplugin.autoComplete.autocomplete&&(this.supportAutocomplete=!0),this.options.customLabelFormatter&&(this.customLabelFormatter=a.Z.getGlobalFunction(this.options.customLabelFormatter,this.scope_id)),this.options.customSearchStrArrFunction&&(this.customSearchStrArrFunction=a.Z.getGlobalFunction(this.options.customSearchStrArrFunction,this.scope_id)),this.myhelper=new WebSquare.korHelper,this.beforeEditValue="",this._preventKeyObj={},this.options.preventKeyList)if("all"===this.options.preventKeyList)this._preventKeyObj.all=!0;else for(var d=this.options.preventKeyList.split(","),p=0;p<d.length;p++){var u=d[p].wq_trim();u&&(this._preventKeyObj[u]=!0)}this._keyBuffer="",this.keyCharHash={48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",110:".",111:"/",106:"*",107:"+",109:"-",187:"=",189:"-",192:"`","220 ":"\\"},this.korCharHash={65:"ㅁ",67:"ㅊ",68:"ㅇ",69:"ㄷ",70:"ㄹ",71:"ㅎ",81:"ㅂ",82:"ㄱ",83:"ㄴ",84:"ㅅ",86:"ㅍ",87:"ㅈ",88:"ㅌ",90:"ㅋ"},this.korCharHash2={69:"ㄸ",81:"ㅃ",82:"ㄲ",84:"ㅆ",87:"ㅉ"},this.resizeObj={width:0,height:0,innerHeight:0},this._itemTableRenderPosition="body",!0===this.options.accessibility&&a.Z.isMobile()&&(this._itemTableRenderPosition="component"),this.options.blurEventControl&&this.options.userEvents.push("onblur")}catch(e){n.Y.printStackTrace(e,null,this)}},"minimum"==r.q.loadingMode&&(u.prototype.initAsync=async function(){try{var e=this.element;if(e){var t=WebSquare.Elem.api.getElementsByTagName(e,"choices",o.I._XML_NAMESPACE.W2)[0];if(t){var i=WebSquare.Elem.api.getElementsByTagName(t,"gridItemset",o.I._XML_NAMESPACE.W2)[0];null==i&&(i=WebSquare.Elem.api.getElementsByTagName(t,"gridViewItemset",o.I._XML_NAMESPACE.W2)[0]),i&&"w2:gridItemset"==i.getTagName()?await requires("uiplugin.grid"):i&&"w2:gridViewItemset"==i.getTagName()&&await requires("uiplugin.gridView")}}}catch(e){n.Y.printStackTrace(e,null,this)}}),u.autocomplete="string"==typeof document.createElement("input").autocomplete,u.prototype.toHTML=function(){try{
var e=[],t=""==this.options.title?"":"title='"+this.options.title+"'",i=""==this.options.style?"":"style='"+this.options.style+"'",s="";s=!0===this.options.disabled?"":""===this.options.tabIndex?"tabIndex='0'":"tabIndex='"+this.options.tabIndex+"'";var r,o=""==this.options.defaultStyle?"":"style='"+this.options.defaultStyle+"'",l=""==this.options.textAlign?o:"style='text-align:"+this.options.textAlign+";"+this.options.defaultStyle+"'",h="text"==this.options.type?"type = 'text' ":"type = '"+this.options.type+"' ",d=""==this.supportAutocomplete||""==this.options.autocomplete?"":" autocomplete='"+this.options.autocomplete+"'",p=this.options.placeholder?"w2autoComplete_label w2autoComplete_placeholder":"w2autoComplete_label";this.options.useLocale&&this.options.placeholderLocaleRef&&(r=this.getLocaleValue(this.options.placeholderLocaleRef));var u=r||this.options.placeholder,m=this.options.placeholder?"data-placeholder='"+u+"' ":"",c="";"none"==this.options.appearance&&(c=" w2autoComplete_ul_col_arrow_hide");var b=WebSquare.language.getMessage("AutoComplete_label")||"AutoComplete";if("native"==this.options.renderType)p=this.options.placeholder?"w2autoComplete_ul_label w2autoComplete_placeholder":"w2autoComplete_ul_label",e.push("<div id='"+this.id+"' "+i+" class='w2autoComplete_acc "+this.options.className+"' "+s+" "+t+">"),e.push("<div id='"+this.id+"_div_input' class='w2autoComplete_ul_col_label'>"),e.push("<input id='"+this.id+"_input' role = 'combobox' aria-expanded = 'false' aria-haspopup = 'true' auto-complete = 'list' aria-owns = '#"+this.id+"_itemTable' class='w2autoComplete_input' style='border-width:0px; width:100%; padding:0px; display:none;' "+h+t+d+" />"),e.push("<span id='"+this.id+"_label' class='"+p+"' "+m+l+"></span>"),e.push("</div>"),e.push("<div id='"+this.id+"_div_arrow' class='w2autoComplete_ul_col_arrow"+c+"'>"),e.push("<a id='"+this.id+"_arrow' class='w2autoComplete_col_button' href='javascript:void(null);' aria-haspopup='true' aria-expanded='false'>"+b+"</a>"),e.push("</div>"),e.push("</div>");else if("input"==this.options.renderType){a.Z.isMobile()&&(s=""),p=this.options.placeholder?"w2autoComplete_ul_label w2autoComplete_placeholder":"w2autoComplete_ul_label",e.push("<div id='"+this.id+"' "+i+" class='w2autoComplete_acc "+this.options.className+"' "+s+" "+t+">"),e.push("<div id='"+this.id+"_div_input' class='w2autoComplete_ul_col_label'>");var f=WebSquare.language.getMessage("AutoComplete_inputFormat")||"Input Format";if(1==this.options.removeLabelFor);else{var y=f;this.options.labelForText&&(y=this.options.labelForText),e.push("<label for='"+this.id+"_input' class='w2blind'>"+y+"</label>")}var v=""==this.options.textAlign?"":"text-align:"+this.options.textAlign+";";e.push("<input "+h+" id='"+this.id+"_input' role = 'combobox' aria-expanded = 'false' aria-autocomplete = 'list' class='w2autoComplete_input w2table_sb_ul_col2' style='border-width:0px; width:100%; padding:0px;"+v+"' "+h+t+d+" />"),e.push("<span id='"+this.id+"_label' class='"+p+"' "+m+" style='display:none;'></span>"),e.push("</div>"),e.push("<div id='"+this.id+"_div_arrow' class='w2autoComplete_ul_col_arrow"+c+"'>"),e.push("<button id='"+this.id+"_arrow' class='w2autoComplete_col_button' aria-label='"+b+"' aria-expanded='false' tabindex='-1' style='border:0'></button>"),e.push("</div>"),e.push("</div>")}else e.push("<div id='"+this.id+"' "+i+" class='w2autoComplete "+this.options.className+"' "+s+" "+t+" role='combobox' aria-labelledby='"+this.id+"_itemTable' aria-autocomplete='inline' >"),e.push("<table class='w2autoComplete_table_main'>"),e.push("<tbody id='"+this.id+"_main_tbody'>"),e.push("<tr class='w2autoComplete_row w2autoComplete_row_main'>"),e.push("<td class='w2autoComplete_col_label' "+o+">"),e.push("<div class='w2autoComplete_label'>"),e.push("<span id='"+this.id+"_label' class='"+p+"' "+m+l+"></span>"),
e.push("<input id='"+this.id+"_input' class='w2autoComplete_input' style='border-width:0px; width:100%; padding:0px; display:none;' "+h+t+d+" />"),e.push("</div></td>"),"none"!=this.options.appearance&&e.push("<td class='w2autoComplete_col_button' id='"+this.id+"_button' aria-labelledby='"+this.id+"_itemTable' aria-controls='"+this.id+"_itemTable'></td>"),e.push("</tr></tbody>"),e.push("</table>"),e.push("</div>");return e.join("")}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.setPreAction=function(){try{if(this.options.itemTooltipDisplay&&this.options.itemTooltipFormatter&&(this.itemTooltipFormatter=a.Z.getGlobalFunction(this.options.itemTooltipFormatter,this.scope_id)),this.dom.button=this.getElementById(this.id+"_button"),this.dom.label=this.getElementById(this.id+"_label"),this.dom.input=this.getElementById(this.id+"_input"),"native"==this.options.renderType||"input"==this.options.renderType){if(this.dom.divInput=this.getElementById(this.id+"_div_input"),this.dom.divArrow=this.getElementById(this.id+"_div_arrow"),this.dom.imgArrow=this.getElementById(this.id+"_arrow"),this.scope_obj&&this.scope_obj.uuid!==(WebSquare.strictModeFrame?WebSquare.strictModeFrame.uuid:"")){var e=this;this.scope_obj.bind("onsetsize",(function(){!1===e._setSetting&&(e.setSetting(),e._setSetting=!0)}))}h.q.addCheckResize(this.uuid,"checkResize")}""!=this.options.tabIndex&&(this.dom.input.tabIndex=this.options.tabIndex),WebSquare.util.isTouchDevice()?"grid"==this.itemTableMode||"gridView"==this.itemTableMode?("grid"===this.itemTableMode?WebSquare.getBody().getLayerListener().useOtherComponentId[this.id]=this.id+"_gridItemTable":WebSquare.getBody().getLayerListener().useOtherComponentId[this.id]=this.id+"_gridViewItemTable",WebSquare.getBody().getLayerListener().addListener({component:this,fnShow:this._openOtherLayer,fnHide:this._closeOtherLayer,paramHide:{documentClick:!0},event:{ontouchstart:this.handleClickEventDocument}})):WebSquare.getBody().getLayerListener().addListener({component:this,fnShow:this._openSubLayer,fnHide:this._closeSubLayer,event:{ontouchstart:this.handleClickEventDocument}}):this.options.useOtherComponentId?o.I.setTimer((function(){this.otherComponent=a.Z.getComponentById(this.options.useOtherComponentId),WebSquare.getBody().getLayerListener().useOtherComponentId[this.id]=this.options.useOtherComponentId,WebSquare.getBody().getLayerListener().addListener({component:this,fnShow:this._openOtherLayer,fnHide:this._closeOtherLayer,event:{onmousedown:this.handleClickEventDocument}}),this.event.addListener(this.otherComponent.render,"onmousedown",this.event.bindAsEventListener(this.otherComponent,(function(e){l.f.stopPropagation(e)}))),this.otherComponent.hide()}),{key:this.options.useOtherComponentId,caller:this,delay:100}):"grid"==this.itemTableMode||"gridView"==this.itemTableMode?("grid"===this.itemTableMode?WebSquare.getBody().getLayerListener().useOtherComponentId[this.id]=this.id+"_gridItemTable":WebSquare.getBody().getLayerListener().useOtherComponentId[this.id]=this.id+"_gridViewItemTable",WebSquare.getBody().getLayerListener().addListener({component:this,fnShow:this._openOtherLayer,fnHide:this._closeOtherLayer,paramHide:{documentClick:!0},event:{onmousedown:this.handleClickEventDocument}})):WebSquare.getBody().getLayerListener().addListener({component:this,fnShow:this._openSubLayer,fnHide:this._closeSubLayer,event:{onmousedown:this.handleClickEventDocument}})}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.setAction=function(){try{if("native"!=this.options.renderType&&"input"!=this.options.renderType||this.setSetting(),this.options.nextTabID&&this.setNextTabID(this.options.nextTabID,this.scope_id),this.event.addListener(this.dom.input,"onblur",this.event.bindAsEventListener(this,this.handleblurEventInput)),"input"!==this.options.renderType&&this.event.addListener(this.dom.input,"onfocus",this.event.bindAsEventListener(this,this.handleFocusEventInput)),
a.Z.isTouchDevice()&&(this.event.addListener(this.render,"ontouchstart",this.event.bindAsEventListener(this,this.handleMousedownEvent)),this.event.addListener(this.render,"ontouchmove",this.event.bindAsEventListener(this,(function(e){var t=!1;"component"==this._itemTableRenderPosition&&(t=e.target&&e.target.parentElement.parentElement.className.indexOf("w2table_sb_fixed")>=0),1!=r.q.getBody().getLayerListener().existShow||t||r.q.getBody().getLayerListener().hideAll()})))),this.event.addListener(this.render,"onmousedown",this.event.bindAsEventListener(this,this.handleMousedownEvent)),this.event.addListener(this.render,"onclick",this.event.bindAsEventListener(this,this.handleClickEvent)),this.event.addListener(this.dom.input,"onkeypress",this.event.bindAsEventListener(this,this.handleKeypressEvent)),this.event.addListener(this.dom.input,"onkeyup",this.event.bindAsEventListener(this,this.handleInputKeyupEvent)),this.event.addListener(this.render,"onkeyup",this.event.bindAsEventListener(this,this.handleKeyupEvent)),this.options.validateOnInput&&this.event.addListener(this.dom.input,"oninput",this.event.bindAsEventListener(this,this.handleInputEvent)),this.event.addListener(this.render,"onmousewheel",this.event.bindAsEventListener(this,this.handleMousewheelEvent)),this.event.addListener(this.render,"onfocus",this.event.bindAsEventListener(this,this.handleFocusEvent)),this.event.addListener(this.render,"onblur",this.event.bindAsEventListener(this,this.handleBlurEvent)),this.event.addListener(this.render,"onmouseover",this.event.bindAsEventListener(this,this.handleMouseoverEvent)),this.event.addListener(this.render,"onmouseout",this.event.bindAsEventListener(this,this.handleMouseoutEvent)),this.bind("onviewchange",(function(e){this.onchangeFlag=!0})),1==this.options.closeonmouseleave&&this.event.addListener(this.render,"onmouseleave",this.event.bindAsEventListener(this,this.handleMouseleaveEvent)),"native"==this.options.renderType?(this.event.addListener(this.dom.imgArrow,"onfocusin",this.event.bindAsEventListener(this,this.handleArrowFocusInEvent)),this.event.addListener(this.render,"onkeydown",this.event.bindAsEventListener(this,this.handleKeydownEvent))):"input"==this.options.renderType?(this.event.addListener(this.dom.input,"onkeydown",this.event.bindAsEventListener(this,this.handleKeydownAccessibilityEvent)),this.event.addListener(this.dom.input,"onfocus",this.event.bindAsEventListener(this,this.handleInputFocusEvent))):this.event.addListener(this.render,"onkeydown",this.event.bindAsEventListener(this,this.handleKeydownEvent)),this.modelControl.isItemsetBinded()&&(this.refreshItemArr(),this.componentRedraw("init")),this.modelControl.isBinded()){var e=this.modelControl.getData();this.setValueNM(e)}-1!=this.selectedIndex||0!=this.options.emptyIndex&&this.options.emptyIndex?this.options.emptyIndex&&"number"==typeof this.options.emptyIndex&&(this.setSelectedIndexNM(this.options.emptyIndex),this.modelControl.isBinded()&&this.modelControl.setData(this.getValue())):(this.setSelectedIndexNM(0),this.modelControl.isBinded()&&this.modelControl.setData(this.getValue())),this.options.readOnly&&this.onPropertyChange("readOnly",a.Z.getBoolean(this.options.readOnly)),this.options.mandatory&&this.onPropertyChange("mandatory",a.Z.getBoolean(this.options.mandatory))}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.refreshItemset=function(e){try{if(this.modelControl.isItemsetBinded())if(this._itemTableRedraw=!0,this.refreshItemArr(),this.componentRedraw(e),this.itemArr.length<=0&&-1!=this.selectedIndex&&this.initAutoComplete(),"grid"==this.itemTableMode?(this.refreshGridItemArr(),null!=this.itemTable&&null!=this.itemTable.grid&&this.setGridData()):"gridView"==this.itemTableMode&&(this.refreshGridViewItemArr(),null!=this.itemTable&&null!=this.itemTable.gridView&&this.setGridViewData()),
this.modelControl.isBinded())this.refresh();else if(-1===this.selectedIndex&&"gridView"===this.itemTableMode&&!1===this.options.selectedData&&"useData"===this.options.noResult)this.setSelectedIndexNM(-1,!0);else{var t=this.options.placeholder?-1:0;this.setSelectedIndexNM(t)}this.isOpen&&this.setItemTable(),this.broadcast({linkedDataList:["refresh"]})}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.refresh=function(){try{if(this.modelControl.isBinded()){var e=this.modelControl.getData();if(this.getItemCount()>0){var t=this.getValue(),i=this.setValueNM(e);if(1==i)t!=this.getValue()&&l.f.fireEvent(this,"onchange",{oldValue:t,newValue:this.getValue()}),null!=this.getValue()&&e!=this.getValue()&&this.modelControl.setData(this.getValue()),this.broadcast({linkedDataList:["refresh",["replace"]]});else if(isNaN(i))null!=this.getValue()&&e!=this.getValue()&&this.modelControl.setData(this.getValue());else if("clear"===this.noResult||this.options.emptyItem)this.setSelectedIndex(-1,!0,!1);else if("previous"===this.noResult){var s=this.options.placeholder?-1:0;this.setSelectedIndex(s,!1,!1)}else{if("noEnd"===this.noResult)return;if("useData"===this.noResult)return void(void 0!==e&&"addItem"===this.options.valueNotInList&&this._setValueNotInList(e,void 0,!1));if("first"===this.noResult)return void(this.options.noResultFirstItem&&this.setSelectedIndex(0))}}else e&&this._setValueNotInList(e,void 0,!1)}}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.componentRedraw=function(e){try{if(this.showRowIndex=0,this.setSelectOptions(),this.itemArr.length>0){var t=0;(this.options.placeholder||"useData"===this.noResult&&"gridView"===this.itemTableMode&&!1===this.options.selectedData)&&(t=-1),e&&"replace"!==e&&this.getSelectedIndex()>-1&&(t=this.getSelectedIndex()),this.itemArr&&this.itemArr[t]?this.dom.label.innerHTML=this.options.escape?this._encode(this.itemArr[t].label):this.itemArr[t].label:this.dom.label.innerHTML="";var i="replace"===e&&!0===this.options.setNodeSetNoOnchange;"init"===e&&!0===this.options.setInitOnchangeSkip&&(i=!0),this.modelControl.isBinded()?this.setSelectedIndex(t,!1,!1,i):this.setSelectedIndex(t,void 0,void 0,i)}else this.dom.label.innerHTML="";"input"!=this.options.renderType&&this.showEditMode(!1),this.setValueNM("")}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.setSubLayer=function(){try{if(null==this.itemTable){var e=this;if("grid"==this.itemTableMode)this.itemTable=new WebSquare.uiplugin.gridItemTable(this.id+"_gridItemTable",{itemsetObj:this.itemsetObj,className:this.options.className,gridOptions:this.gridOptions,visibleRowNum:this.options.visibleRowNum,findItemKor:this.options.findItemKor,findItemFirstKey:this.options.findItemFirstKey,parent_uuid:this.uuid}),this.itemTable.writeTo(WebSquare.getBody(),null,this.parentFrame),this.itemTable.activate(),this.itemTable.grid.addEvent("oncellclick",(function(t,i){e.findStop=!0,(e.editmode||e.findkeymode)&&(e.mozTrickBuffer=""),e.focus(),"dataList"===e.gridOptions.dataComp.initializeType&&(t=this.getRealRowIndex(t)),e.setSelectedIndex1(e.viewArr[t].index)})),this.event.addListener(this.itemTable.grid.render,"onkeydown",this.event.bindAsEventListener(this.itemTable.grid,(function(t){var i=t.charCode?t.charCode:t.keyCode;if(13==i){e.focus();var s=this.getFocusedRowIndex();"dataList"===e.gridOptions.dataComp.initializeType&&(s=this.getRealRowIndex(s)),e.setSelectedIndex1(e.viewArr[s].index)}else 27==i&&(e._closeSubLayer(),e.showEditMode(!1),e.focus())}))),0===this.itemArr.length&&this.itemTable.hide();else if("gridView"==this.itemTableMode)"auto"==this.options.submenuSize&&(this.gridViewOptions.width||(this.gridViewOptions.parentWidth=this.render.offsetWidth),this.gridViewOptions.autoFit="allColumn"),this.itemTable=new WebSquare.uiplugin.gridViewItemTable(this.id+"_gridViewItemTable",{itemsetObj:this.itemsetObj,className:this.options.className,gridViewOptions:this.gridViewOptions,visibleRowNum:this.options.visibleRowNum,
findItemKor:this.options.findItemKor,findItemFirstKey:this.options.findItemFirstKey,parent_uuid:this.uuid}),this.itemTable.writeTo(WebSquare.getBody(),null,this.parentFrame),this.itemTable.activate(),this.itemTable.gridView.addEvent("oncellclick",(function(t,i){e.findStop=!0,(e.editmode||e.findkeymode)&&(e.mozTrickBuffer=""),e.itemTable._focus(),e._focusSkip=!0;var s=e.viewArr[t].orgLabel+"|"+e.viewArr[t].value,r=e.findinItemArr(s,WebSquare.allValue||"all");e.setSelectedIndex1(r)})),this.event.addListener(this.itemTable.gridView.render,"onkeydown",this.event.bindAsEventListener(this.itemTable.gridView,(function(t){var i=t.charCode?t.charCode:t.keyCode;if(13==i){e.itemTable._focus(),e._focusSkip=!0;var s=this.getFocusedRowIndex();"dataList"===e.gridViewOptions.dataComp.initializeType&&(s=this.getRealRowIndex(s)),e.setSelectedIndex1(e.viewArr[s].index)}else 27==i&&(e._closeSubLayer(),e.showEditMode(!1),e.itemTable._focus(),e._focusSkip=!0)}))),0===this.itemArr.length&&this.itemTable.hide();else{var t={row:this.options.visibleRowNum,col:1,submenuSize:this.options.submenuSize,style:"",defaultStyle:"text-align:"+this.options.textAlign+";"+this.options.defaultStyle,className:"w2input_table "+this.options.className,w2table:"w2input_table_sb",w2table_main:"w2input_table_sb_main",w2table_row:"w2input_table_sb_row",w2table_col:"w2input_table_sb_col",w2table_col_over:"w2input_table_sb_col_over",escape:this.options.escape,wheelRows:this.options.wheelRows,parent_uuid:this.uuid,selectByTabKey:this.options.selectByTabKey};"native"!==this.options.renderType&&"input"!==this.options.renderType||(t.className="w2table "+this.options.className,t.w2table="w2table_sb",t.w2table_main="w2table_sb_ul_main",t.w2table_row="w2table_sb_ul_row",t.w2table_col="w2table_sb_ul_col",t.tableRender="ul",t.noUseUpDownKey=!1,t.noUseTabKeyByMove=!0),"native"===this.options.renderType?t.w2table_col_over="w2table_sb_ul_col_over":"input"===this.options.renderType?(t.w2table_col_over="w2table_sb_ul_col_over2",t.parentPluginName="autoComplete_input",t.defaultStyle=""==this.options.textAlign?this.options.defaultStyle:"text-align:"+this.options.textAlign+";"+this.options.defaultStyle):t.useFindItemFirstKeyChar=this.options.useFindItemFirstKeyChar,"component"==this._itemTableRenderPosition&&(t.w2table="w2table_sb_fixed"),this.itemTable=new WebSquare.uiplugin.itemTable(this.id+"_itemTable",t),"component"==this._itemTableRenderPosition?this.itemTable.writeTo(this,null,this.parentFrame):this.itemTable.writeTo(WebSquare.getBody(),null,this.parentFrame),this.itemTable.activate(),"input"===this.options.renderType&&(this.itemTable.addMouseOverEventListener((function(t){this.selectedCell&&e.dom.input.setAttribute("aria-activedescendant",this.selectedCell.id)})),this.itemTable.addMouseLeaveEventListener((function(t){e.dom.input.removeAttribute("aria-activedescendant")}))),this.itemTable.addClickEventListener((function(t,s){if("input"!==e.options.renderType||s){l.f.fireEvent(e,"onitemclick",s),e.findStop=!0;var r=e.selectedIndex,o=e.getValue();if(e.editmode||e.findkeymode){e.mozTrickBuffer="";var n=e.viewArr[s].label;e.options.useKeywordHighlight&&(n=n.wq_replaceAll("<span class='w2autoComplete_keyword'>","").wq_replaceAll("</span>","")),e.dom.input.value=n,e.selectedItem={text:n,value:e.viewArr[s].value,orgLabel:e.viewArr[s].orgLabel};var h=e.selectedItem.orgLabel+"|"+e.selectedItem.value,d=e.findinItemArr(h,WebSquare.allValue||"all");e.setSelectedIndex1(d,!0),"input"!=e.options.renderType&&e.focus(),e.closeTable()}else{n=e.viewArr[s].label;if(e.options.useKeywordHighlight&&(n=n.wq_replaceAll("<span class='w2autoComplete_keyword'>","").wq_replaceAll("</span>","")),e.dom.input.value=n,e.selectedItem={text:n,value:e.viewArr[s].value,orgLabel:e.viewArr[s].orgLabel},"native"===e.options.renderType)"arrow"==e.options.itemEnterHandleMode?(e.setSelectedIndex1(e.viewArr[s].index),e.dom.imgArrow.focus()):"edit"==e.options.itemEnterHandleMode?(e.setSelectedIndex1(e.viewArr[s].index),
e.focus()):(e.focus(),e.setSelectedIndex1(e.viewArr[s].index));else if("input"===e.options.renderType){if(e.setSelectedIndex1(s),!0===e.options.accessibility&&a.Z.isMobile()){var p=this.render.querySelectorAll("."+this.options.w2table_col);for(i=0;i<p.length;i++)this.removeClass(p[i],this.options.w2table_col_over);this.selectedCell=null}}else e.setSelectedIndex1(s),e.focus(),e.closeTable()}var u={oldValue:o,newValue:e.getValue(),oldSelectedIndex:r,newSelectedIndex:e.selectedIndex};l.f.fireEvent(e,"onselected",u)}})),this.itemTable.addKeyDownEventListener((function(t){var i=t.charCode?t.charCode:t.keyCode;if("input"!==this.options.renderType&&"ul"==this.options.tableRender&&e.itemTable.endReached)1==this.getItemCount()&&13==i?e.enterHandle(t):9==i&&(e.closeSubLayer(),e.dom.imgArrow.focus(),e.itemTable.endReached=!1);else{if(a.Z.isIEAllVersion()){if(t.srcElement.parentElement!=this.render)return}else if(l.f.getTarget(t)!==this.render)return void("ul"==this.options.tableRender&&9==i&&(e._setLabel(e.viewArr[this.getSelectedIndex()].index),e.showEditMode(!1)));if(27==i)return e._closeSubLayer(),"input"!==this.options.renderType&&e.showEditMode(!1),void e.focus();if(e.options.customToggleKey==i)return e._closeSubLayer(),void e.focus();if(!e.options.findItemFirstKey)if(1==e.interactionMode||e.editmode||e.findkeymode){for(var s=0,r=e.selectedItem.orgLabel+"|"+e.selectedItem.value,o=0;o<e.viewArr.length;o++)if(r==e.viewArr[o].orgLabel+"|"+e.viewArr[o].value){s=o;break}if(13==i||e.options.selectByTabKey&&9==i){if(0==e.viewArr.length)return}else if(38==i||9==i&&t.shiftKey){if(0==s)return;s-=1}else if(40==i||9==i){if(s+1==e.viewArr.length)return;s+=1}else 35==i?s=e.viewArr.length-1:36==i?s=0:33==i?(s-=e.viewArr.length)<0&&(s=0):34==i&&(s+=e.viewArr.length)>=e.viewArr.length&&(s=e.viewArr.length-1);if(e.viewArr.length>s){var n=e.viewArr[s].label;e.options.useKeywordHighlight&&(n=n.wq_replaceAll("<span class='w2autoComplete_keyword'>","").wq_replaceAll("</span>","")),e.dom.input.value=n,e.selectedItem={text:n,value:e.viewArr[s].value,orgLabel:e.viewArr[s].orgLabel},e.itemTable.setSelectedIndex(s)}}else{var h=-1;h=e.getSelectedIndex(),38==i||9==i&&t.shiftKey?h>0&&(h-=1):40==i||9==i?h+1<e.getItemCount()&&(h+=1):35==i?h=e.getItemCount()-1:36==i?h=0:33==i?(h-=e.itemTable.rowCount)<0&&(h=0):34==i&&(h+=e.itemTable.rowCount)>=e.itemTable.getItemCount()&&(h=e.itemTable.getItemCount()-1),e.setSelectedIndex1(h,!0),e.itemTable.setSelectedIndex(h)}}}));var s=WebSquare.idCache[this.uuid],r=this.options.closeonmouseleave,o=this.options.itemTooltipDisplay;(r||o)&&this.itemTable.addMouseLeaveEventListener((function(t){if(r){var i=e.render.offsetHeight,n=e.getAbsolutePosition("top");t.clientY>=n&&t.clientY<=n+i||e.closeSubLayer()}o&&s.hideTooltip()})),o&&this.itemTable.addMouseOverEventListener((function(e){var t=a.Z.getDataPrefix("index"),i=e,r=WebSquare.style.getAbsoluteLeft(i)+20,o=WebSquare.style.getAbsoluteTop(i)+i.offsetHeight+3,n="ul"===s.options.tableRender?i.innerText:i.innerHTML;if(s.itemTooltipFormatter&&"function"==typeof s.itemTooltipFormatter){var l=parseInt(i.getAttribute(t),10);n=s.itemTooltipFormatter(n,l,s.options._rowIndex,s.options._colIndex)}s.showTooltip(r,o,n)})),this.editmode&&this.viewArr.length>0?(this.setItemTable(),"native"!=this.options.renderType&&"input"!=this.options.renderType&&this.itemTable.setSelectedIndex(0)):null!=this.itemArr&&this.itemArr.length>0?this.setItemTable():(this.itemTable.hide(),null!=this.itemTable.mainTable&&this.itemTable.render.firstChild?this.setItemTable():$l("this.itemTable.mainTable is null.["+this.id+"]"))}if("native"===this.options.renderType||"input"===this.options.renderType){var h=this.dom.input;h&&h.setAttribute("aria-controls",this.id+"_itemTable_main")}if("native"===this.options.renderType){var d=this.dom.imgArrow;d&&d.setAttribute("aria-controls",this.id+"_itemTable_main")}this.isOpen=!0,this.closeSubLayer()}}catch(e){n.Y.printStackTrace(e,null,this)}},
u.prototype.setSelectOptions=function(){try{null!=this.itemTable&&(this.editmode?0==this.viewArr.length||"grid"!=this.itemTableMode&&"gridView"!=this.itemTableMode&&(this.itemTable.setItemArr(this.viewArr),this.itemTable.setSelectedIndex(0)):"grid"!=this.itemTableMode&&"gridView"!=this.itemTableMode&&null!=this.itemArr&&0!=this.itemArr.length?this.itemTable.setItemArr(this.itemArr):this.itemTable.hide())}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.setItemTable=function(){try{var e,t;"native"===this.options.renderType||"input"==this.options.renderType?(e=this.itemTable.render.getElementsByTagName("li"),t=this.itemTable.render.getElementsByTagName("li")):(e=this.itemTable.render.getElementsByTagName("tr"),t=this.itemTable.render.getElementsByTagName("td")),(e.length!==this.itemArr.length||this.viewArr.length!==this.itemArr.length||this._itemTableRedraw)&&(this._itemTableRedraw=!1,this.itemTable.setItemArr(this.viewArr));var i,s=this.render.offsetWidth;if(t&&t.length>0){i=0;for(var r=this.options.visibleRowNum,l=this.editmode?this.viewArr:this.itemArr,a=0,h=0;h<l.length&&r>0;h++)this.options.visibleColumn&&this.options.visibleColumnFalseValue&&!0===l[h]._hidden||(i+=t[h].offsetHeight,r--,a++);o.I.browserCheck.moz&&i<34&&1===a&&(i=34),this.itemTable.setStyle("height",i+"px")}var d=0;"auto"==this.options.submenuSize&&(d=WebSquare.style.getSize(this.itemTable.render,"innerwidth")-WebSquare.style.getSize(this.itemTable.render,"width")),"fixed"==this.options.submenuSize||parseInt(s)>=parseInt(this.itemTable.render.offsetWidth)?(this.itemTable.setStyle("width",s-2-d+"px"),this.itemTable.render.offsetHeight>=this.itemTable.render.scrollHeight?this.itemTable.render.firstChild.style.width=s-d+"px":this.itemTable.render.firstChild.style.width=s-17-d+"px"):this.itemTable.render.scrollHeight-this.itemTable.render.offsetHeight>1?this.itemTable.setStyle("width",this.itemTable.render.firstChild.offsetWidth+17+"px"):this.itemTable.render.firstChild.offsetWidth>s?this.itemTable.setStyle("width",this.itemTable.render.firstChild.offsetWidth+"px"):(this.itemTable.render.firstChild.style.width=s-d+"px",this.itemTable.setStyle("width",s-2-d+"px"));var p=this.options.direction;if("auto"==p){var u=document.body.scrollTop;u<document.documentElement.scrollTop&&(u=document.documentElement.scrollTop);var m=WebSquare.style.getAbsoluteTop(this.render)-u,c=document.documentElement.clientHeight-(m+this.render.offsetHeight),b=this.itemTable.render.offsetHeight,f=Math.max(c,m);if(f<b&&t&&t.length>0){var y=0;for(h=0;h<t.length&&!(y+t[h].offsetHeight+2>f);h++)y+=t[h].offsetHeight;this.itemTable.rowCount=h,this.itemTable.setStyle("height",y+"px"),f!==c&&(p="up")}else c<b&&m>b&&(p="up")}p&&(this._direction=p),i&&(this._tdHeight=i),this._setItemTableBody(p,i)}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype._setItemTableCommon=function(e,t,i,s){try{var r=document.documentElement.clientWidth||document.body.clientWidth||0,o=WebSquare.style.getAbsoluteLeft(this.render);if(r<o+this.itemTable.render.offsetWidth){var l=o+this.render.offsetWidth-this.itemTable.render.offsetWidth;if("body"==this._itemTableRenderPosition&&(t=t+this.render.offsetWidth-this.itemTable.render.offsetWidth),l<0){"body"==this._itemTableRenderPosition&&(t=WebSquare.style.getAbsoluteLeft(this.render));var a=document.body.offsetWidth-17-WebSquare.style.getAbsoluteLeft(this.render);this.itemTable.setStyle("width",a+"px"),"auto"!=this.itemTable.getStyle("overflow-x")&&(s+=20),this.itemTable.setStyle("height",s+"px"),this.itemTable.setStyle("overflow-x","auto")}else this.itemTable.setStyle("overflow-x","hidden")}else{a=this.itemTable.render.firstChild.offsetWidth;var h=this.itemTable.render.clientWidth;if(o+a<r&&"auto"==this.itemTable.getStyle("overflow-x")){var d=a>h?a:h;s-=20,this.itemTable.setStyle("height",s+"px"),this.itemTable.setStyle("width",d+"px"),this.itemTable.setStyle("overflow-x","hidden")}}this.itemTableDirection=e,this.itemTable.render.style.left=t+"px",
this.itemTable.render.style.top=i+"px",WebSquare.style.adjustZIndex(this.uuid,this.itemTable.uuid,"itemTable")}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype._setItemTableBody=function(e,t){try{var i=0;i="up"==e?WebSquare.style.getAbsoluteTop(this.render)-this.itemTable.render.offsetHeight:WebSquare.style.getAbsoluteTop(this.render)+this.render.offsetHeight;var s=WebSquare.style.getAbsoluteLeft(this.render);"component"==this._itemTableRenderPosition&&(i-=document.documentElement.scrollTop),this._setItemTableCommon(e,s,i,t)}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype._setItemTableComponent=function(e,t){try{var i=0,s=0,r=0,o=0,l=0;WebSquare.style.getComputedStyle(this.render,"border-top-width")&&(s=1*WebSquare.style.getComputedStyle(this.render,"border-top-width").replace("px","")),WebSquare.style.getComputedStyle(this.render,"padding-top")&&(r=1*WebSquare.style.getComputedStyle(this.render,"padding-top").replace("px","")),WebSquare.style.getComputedStyle(this.render,"border-bottom-width")&&(o=1*WebSquare.style.getComputedStyle(this.render,"border-bottom-width").replace("px","")),WebSquare.style.getComputedStyle(this.render,"padding-bottom")&&(l=1*WebSquare.style.getComputedStyle(this.render,"padding-bottom").replace("px","")),i="up"==e?-this.itemTable.render.offsetHeight-(s+r):this.render.offsetHeight-(o+l);var a=this.render.offsetWidth-this.itemTable.render.offsetWidth,h=0,d=0;WebSquare.style.getComputedStyle(this.render,"border-left-width")&&(h=1*WebSquare.style.getComputedStyle(this.render,"border-left-width").replace("px","")),WebSquare.style.getComputedStyle(this.render,"padding-left")&&(d=1*WebSquare.style.getComputedStyle(this.render,"padding-left").replace("px","")),a-=h+d,this._setItemTableCommon(e,a,i,t)}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.buildItemArr=function(){try{this.modelControl.setItemset(this.itemsetObj.nodeset,this.itemsetObj.label,this.itemsetObj.value),this.itemArr=[],this.itemsetObj.nodeset.match("data:")?(this.itemArr=this.modelControl.getDataCollectionItemsetData(this.id),this.allItemArr=this.modelControl.getDataCollectionItemsetData(this.id,{allData:!0})):this.itemArr=this.modelControl.getItemsetData(),this.options.useLocale&&!1!==this.options.useItemLocale&&(this.itemArr=this.getLocaleItemArr(this.itemArr),this.allItemArr=this.getLocaleItemArr(this.allItemArr))}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.setSelectItemArr=function(){try{if(""!=this.options.sortOption){var e=[],t=null;"label"==this.options.sortOption?t=function(){return this.label}:"value"==this.options.sortOption&&(t=function(){return this.value});for(var i=0;i<this.itemArr.length;i++){var s=this.itemArr[i];s.toString=t,e.push(s)}e.sort(),"descending"==this.options.sortMethod&&e.reverse(),this.itemArr=e}for(i=0;i<this.itemArr.length;i++)this.itemArr[i].orgLabel=this.itemArr[i].orgLabel||this.itemArr[i].label,this.itemArr[i].label=this.getItemText(i);if(1==this.options.allOption&&(this.itemArr=[{label:this.defaultAllOptionLabel,value:WebSquare.allValue,orgLabel:this.defaultAllOptionLabel,noItem:!0}].concat(this.itemArr)),1==this.options.chooseOption){var r=this._getChooseOptionLabel();this.itemArr=[{label:r,value:this.options.chooseOptionValue,orgLabel:r,noItem:!0}].concat(this.itemArr)}this.viewArr=[];for(i=0;i<this.itemArr.length;i++)this.viewArr.push({label:this.itemArr[i].label,value:this.itemArr[i].value,orgLabel:this.itemArr[i].orgLabel,index:i,_hidden:this.itemArr[i]._hidden,_disabled:this.itemArr[i]._disabled})}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.getViewItemText=function(e){try{var t="";if(e>-1&&e<this.viewArr.length)switch(t=this.viewArr[e].label,this.options.displayMode){case"0":break;case"1":t=this.viewArr[e].value+this.options.delimiter+t;break;case"2":t=t+this.options.delimiter+this.viewArr[e].value;break;case"3":t=this.viewArr[e].value}return t}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.parseLabel=function(e){try{
if(this.itemsetObj.label.indexOf("@")>-1){var t=this.itemsetObj.label.split("@");if(this.itemsetObj.label.indexOf("/")>-1){var i=t[0].split("/"),s=i[i.length-2],r=WebSquare.xml.getElementsByTagName(this.itemArr[e].xml,s);return WebSquare.WebSquareparser.getAttribute(r[0],t[1])}return WebSquare.WebSquareparser.getAttribute(this.itemArr[e].xml,t[1])}return(r=WebSquare.xml.getElementsByTagName(this.itemArr[e].xml,this.itemsetObj.label))[0].firstChild.nodeValue}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.parseValue=function(e){try{if(this.itemsetObj.label.indexOf("@")>-1){var t=this.itemsetObj.value.split("@");if(this.itemsetObj.label.indexOf("/")>-1){var i=t[0].split("/"),s=i[i.length-2],r=WebSquare.xml.getElementsByTagName(this.itemArr[e].xml,s);return WebSquare.WebSquareparser.getAttribute(r[0],t[1])}return WebSquare.WebSquareparser.getAttribute(this.itemArr[e].xml,t[1])}return(r=WebSquare.xml.getElementsByTagName(this.itemArr[e].xml,this.itemsetObj.label))[0].firstChild.nodeValue}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.setItemSet=function(e,t,i){try{void 0===this.itemsetObj&&(this.itemsetObj={});var s=!1;if(t==this.itemsetObj.label&&i==this.itemsetObj.value||(s=!0),this.itemsetObj.nodeset=e,s&&(this.itemsetObj.label=t,this.itemsetObj.value=i),"grid"==this.itemTableMode){if(this.modelControl.setItemset(this.itemsetObj.nodeset,this.itemsetObj.label,this.itemsetObj.value),s)for(var r=0;r<this.itemsetObj.items.length;r++)this.itemsetObj.items[r].id==this.itemsetObj.labelId&&(this.itemsetObj.items[r].ref=t),this.itemsetObj.items[r].id==this.itemsetObj.valueId&&(this.itemsetObj.items[r].ref=i);this.refreshGridItemArr()}else"gridView"==this.itemTableMode?(this.modelControl.setItemset(this.itemsetObj.nodeset,this.itemsetObj.label,this.itemsetObj.value),this.refreshGridViewItemArr()):this.buildItemArr();for(r=0;r<this.itemArr.length;r++)this.itemArr[r].orgLabel=this.itemArr[r].label,this.itemArr[r].label=this.getItemText(r);if(this.options.interactionMode){if(o.I.clearTimer(this.id+"_showEditMode",!0),this.interactionMode&&(this.selectedIndex=-1,this.selectedItem={text:"",value:"",orgLabel:""},"useData"===this.options.noResult&&this.dummyItemArr.length))for(r=0;r<this.dummyItemArr.length;r++)this.itemArr=[{label:this.dummyItemArr[r].label,value:this.dummyItemArr[r].value,orgLabel:this.dummyItemArr[r].orgLabel}].concat(this.itemArr);if(1==this.options.allOption&&this.itemArr.length>0&&(this.itemArr=[{label:this.defaultAllOptionLabel,value:WebSquare.allValue,orgLabel:this.defaultAllOptionLabel,noItem:!0}].concat(this.itemArr),"grid"==this.itemTableMode&&this.gridOptions.dataComp)){for(var l=-1,a={},h=0;h<this.itemsetObj.items.length;h++)-1==l&&this.itemsetObj.items[h].ref==this.itemsetObj.label&&(l=h),a[this.itemsetObj.items[h].id]="";a[this.itemsetObj.items[-1==l?0:l].id]=this.defaultAllOptionLabel,this.gridRowItemArr.unshift(a)}if(1==this.options.chooseOption){t=this._getChooseOptionLabel();this.itemArr=[{label:t,value:this.options.chooseOptionValue,orgLabel:t,noItem:!0}].concat(this.itemArr),this.selectedIndex=0,this.selectedItem={text:this.itemArr[this.selectedIndex].label,value:this.itemArr[this.selectedIndex].value,orgLabel:this.itemArr[this.selectedIndex].orgLabel}}this.viewArr=[];for(r=0;r<this.itemArr.length;r++){var d=this.itemArr[r].label;if(this.options.useKeywordHighlight){var p=d.indexOf(this.mozTrickBuffer);p>=0&&(d=d.substring(0,p)+"<span class='w2autoComplete_keyword'>"+this.mozTrickBuffer+"</span>"+d.substring(p+this.mozTrickBuffer.length,d.length))}this.viewArr.push({label:d,orgLabel:this.itemArr[r].orgLabel,value:this.itemArr[r].value,index:r,_hidden:this.itemArr[r]._hidden,_disabled:this.itemArr[r]._disabled})}}else{if(1==this.options.chooseOption){t=this._getChooseOptionLabel();this.itemArr=[{label:t,value:this.options.chooseOptionValue,orgLabel:t,noItem:!0}].concat(this.itemArr),this.selectedIndex=0,this.selectedItem={text:this.itemArr[this.selectedIndex].label,
value:this.itemArr[this.selectedIndex].value,orgLabel:this.itemArr[this.selectedIndex].orgLabel}}this.viewArr=[];for(r=0;r<this.itemArr.length;r++)this.viewArr.push({label:this.itemArr[r].label,value:this.itemArr[r].value,orgLabel:this.itemArr[r].orgLabel,index:r,_hidden:this.itemArr[r]._hidden,_disabled:this.itemArr[r]._disabled})}if(this.gridOptions.sortIndex&&this.gridItemArr.length>0){if(this.setSubLayer(),this.itemTable.grid.setData(this.gridItemArr.slice(0)),this.options.allOption){var u=[];for(l=-1,h=0;h<this.itemsetObj.items.length;h++)-1==l&&this.itemsetObj.items[h].ref==this.itemsetObj.label&&(l=h),u.push("");u[-1==l?0:l]=this.defaultAllOptionLabel,this.itemTable.grid.setRowData(0,u,!1)}var m=[];if(this.options.allOption){var c=this.gridOptions.sortIndex.split(" ")[0],b=this.itemTable.grid.getCellInfo(c).options.dataType,f=parseInt(this.gridOptions.sortOrder.split(" ")[0],10);m[0]=function(e,t,i,s){return 0==i?-1:0==s?1:("number"==b?(e=Number(e),t=Number(t)):(e=e||"",t=t||""),e>t?1*f:e<t?-1*f:0)}}this.itemTable.grid.multisort({sortIndex:this.gridOptions.sortIndex,sortOrder:this.gridOptions.sortOrder,sortFuncArr:m})}}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.updateTable=function(){},u.prototype.openTable=function(){try{this.showTable()}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.toggle=function(){try{l.f.fireEvent(this,"ontoggleclick",this.isOpen),this.isOpen?this.closeSubLayer():this.openSubLayer()}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.openSubLayer=function(e){try{WebSquare.getBody().getLayerListener().show(this.id,e)}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype._openSubLayer=function(e){try{e||(e={});var t=void 0===e.select||e.select;if(this.setSubLayer(),!this.isOpen){if(0==this.itemArr.length)return;if(this.itemTable.show(),this.addClass("w2autoComplete_open"),"native"===this.options.renderType||"input"==this.options.renderType){var i=this.dom.input;i&&i.setAttribute("aria-expanded","true");var s=this.dom.imgArrow;s&&s.setAttribute("aria-expanded","true")}if("input"==this.options.renderType&&this.itemTable.render.firstChild){var r=WebSquare.language.getMessage("AutoComplete_label")||"AutoComplete";this.itemTable.render.firstChild.setAttribute("aria-label",r)}if("input"!=this.options.renderType&&this.itemTable.render.setAttribute("aria-expanded","true"),this.setItemTable(),1==this.options.wmode&&WebSquare.getBody().showWModeFrame(this.getPluginName(),this.itemTable.render),a.Z.isMobile()||this.options.editable&&!this.options.disableEdit&&(this.editmode||!this.options.findItemFirstKey)||this.itemTable.focus(),-1!=this.selectedIndex&&t){var o=this.selectedIndex;0==o&&(this.itemTable._getCellDisabled(o)||this.itemTable._getCellHidden(o))&&o++,this.itemTable.setSelectedIndex(o)}if(this.editmode&&void 0!==this.dom.input&&null!=this.dom.input&&this.setfFocus(),this.options.animation&&("slideDown"!==this.options.animation||"up"!==this.itemTableDirection)){this.getItemCount()<=this.options.visibleRowNum&&this.itemTable.setStyle("overflow-y","hidden");var l="w2"+this.options.animation;this.addClass(this.itemTable.render,l)}this.isOpen=!0,this.options.customLabelFormatter&&(this.customLabelFormatter=a.Z.getGlobalFunction(this.options.customLabelFormatter,this.scope_id)),"function"==typeof this.customLabelFormatter&&this._setLabel(this.selectedIndex)}}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype._openOtherLayer=function(e){try{if(this.isOpen)this.setGridData();else{if(0==this.itemArr.length)return;var t=this.otherComponent;"grid"==this.itemTableMode?(this.setSubLayer(),this.setGridData(),""!==this.gridOptions.visibleRowNum&&(this.itemTable.render.style.height=this.itemTable.grid.render.style.height),(t=this.itemTable).grid.removeFocusedCell(),t.setPosition(0,0),t.show(),t.grid.handleResize()):"gridView"==this.itemTableMode?(this.setSubLayer(),this.setGridViewData(),null!=(t=this.itemTable).gridView&&null!=t.gridView._dataList&&t.gridView.removeFocusedCell(),
t.setPosition(0,0),t.show(),""!==this.gridViewOptions.visibleRowNum&&(this.itemTable.render.style.height=this.itemTable.gridView.render.offsetHeight+"px"),t.gridView.handleResize()):t.show(),this.addClass("w2autoComplete_open");var i=WebSquare.style.getAbsoluteLeft(this.render),s=WebSquare.style.getAbsoluteTop(this.render),r=this.options.direction;if("auto"==r||"fit"==r){var o=document.body.scrollTop;o<document.documentElement.scrollTop&&(o=document.documentElement.scrollTop);var l=s-o,h=document.documentElement.clientHeight-(l+this.render.offsetHeight),d=t.render.offsetHeight;h<d&&l>d&&(r="up")}if("up"==r)if("gridView"==this.itemTableMode){s-=this.getElementById(this.id+"_gridViewItemTable_gridView_body_table").offsetHeight;var p=this.getElementById(this.itemTable.id+"_gridView_main_div").style.zIndex;this.setStyle("z-index",p+1)}else s-=t.render.offsetHeight;else s+=this.render.offsetHeight;if("fit"==this.options.direction){"grid"!=this.itemTableMode&&"gridView"!=this.itemTableMode||(this.itemTable.render.firstChild.style.width="100%"),i=WebSquare.style.getAbsoluteLeft(this.render),t.setPosition(i,s);var u=document.documentElement.clientWidth-i;t.setSize(u,t.render.offsetHeight)}else"auto"==this.options.submenuSize&&"gridView"==this.itemTableMode&&(i=WebSquare.style.getAbsoluteLeft(this.render),this.gridViewOptions.width||(t.render.style.width=this.render.offsetWidth+"px")),"fit"!=r&&document.documentElement.clientWidth<i+t.render.offsetWidth&&(i=i+this.render.offsetWidth-t.render.offsetWidth),i<0&&(i=0);this.itemTableDirection=r,t.render.style.left=i+"px",t.render.style.top=s+"px",this.isOpen=!0,WebSquare.style.adjustZIndex(this.uuid,t.uuid,"itemTable"),this.options.findItemFirstKey&&(a.Z.isMobile()||this.options.editable&&!this.options.disableEdit&&this.editmode||("grid"==this.itemTableMode?t.grid.render.focus():"gridView"==this.itemTableMode&&t.gridView.render.focus()))}if(-1!=this.selectedIndex)for(var m=0;m<this.viewArr.length;m++)if(this.viewArr[m].index==this.selectedIndex){this.itemTable.setSelectedIndex(m,e&&e.noFocus);break}}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.closeSubLayer=function(){try{WebSquare.getBody().getLayerListener().hide(this.id)}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype._closeSubLayer=function(){try{if(this.isOpen&&null!=this.itemTable){if(this.itemTable.hide(),this.removeClass("w2autoComplete_open"),"input"!=this.options.renderType&&this.itemTable.render.setAttribute("aria-expanded","false"),"native"===this.options.renderType||"input"==this.options.renderType){var e=this.dom.input;e&&e.setAttribute("aria-expanded","false");var t=this.dom.imgArrow;t&&t.setAttribute("aria-expanded","false")}1==this.options.wmode&&WebSquare.getBody().hideWModeFrame(this.getPluginName(),this.itemTable.id),this.isOpen=!1,this.options.customLabelFormatter&&(this.customLabelFormatter=a.Z.getGlobalFunction(this.options.customLabelFormatter,this.scope_id)),"function"==typeof this.customLabelFormatter&&this._setLabel(this.selectedIndex)}}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype._closeOtherLayer=function(e){try{var t=(e=e||{}).documentClick,i=this.otherComponent;"grid"!=this.itemTableMode&&"gridView"!=this.itemTableMode||(i=this.itemTable),this.isOpen&&null!=i&&(i.hide(),this.removeClass("w2autoComplete_open"),"grid"==this.itemTableMode?i.grid.handleResize():"gridView"==this.itemTableMode&&i.gridView.handleResize(),this.isOpen=!1,!0===t?l.f.fireEvent(this,"onclose",!0):l.f.fireEvent(this,"onclose",!1))}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.setSelectedIndex=function(e,t,i,s){try{if(isNaN(e))return;if(a.Z.isNull(e))return;if(e=parseInt(e),this.options.emptyItem&&(e<0||e>=this.getItemCount()))if(this.modelControl.isBinded())(1==this.options.selectedData||0!=i)&&this.modelControl.setData(this.options.emptyValue),this.setSelectedIndexNM(-1);else{var r=this.getSelectedIndex(),o=this.getValue();this.setSelectedIndexNM(-1),-1!=r&&!0!==s&&l.f.fireEvent(this,"onchange",{
oldValue:o,newValue:this.getValue()})}else{if(e>=this.getItemCount())return;if(e<0&&!t)return;var h="";e>-1&&(h=this.itemArr[e].value);var d=this.getValue();1==this.options.selectedData||"gridView"===this.itemTableMode&&!1===this.options.selectedData&&-1===e?this.modelControl.setData(h):0!=i?this.itemArr[e].value!=WebSquare.allValue?(this.modelControl.setData(h),1==this.options.chooseOption&&0==e&&this.setSelectedIndexNM(0)):(this.modelControl.setData(""),this.setSelectedIndexNM(e)):this.setSelectedIndexNM(-1);r=this.getSelectedIndex(),o=this.getValue();this.modelControl.isBinded()&&this.modelControl.getData()===d||this.setSelectedIndexNM(e,t),r!=this.getSelectedIndex()&&(!0!==s&&l.f.fireEvent(this,"onchange",{oldValue:o,newValue:this.getValue()}),this.broadcast({linkedDataList:["refresh"]}))}}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.setSelectedIndexNM=function(e,t){try{if(this.dummyData=null,e=parseInt(e),isNaN(e))return!1;if(this.options.emptyItem&&(e<0||e>=this.getItemCount()))this.selectedIndex=-1,this.dom.label.innerHTML="",this.dom.input.value="",this.itemTable&&this.itemTable.setSelectedIndex(0),this.selectedItem={text:"",value:"",orgLabel:""},"input"!=this.options.renderType&&this.showEditMode(!1);else{if(isNaN(e)||e>=this.getItemCount())return!1;if(e<0&&!t)return!1;if(this.selectedIndex=e,e>-1){"grid"==this.itemTableMode?this.gridOptions.dataComp?this.selectedGridRowObj=this.gridOptions.dataComp.getRowArray(e):this.selectedGridRowObj=this.gridRowItemArr[e]:"gridView"==this.itemTableMode&&this.gridViewOptions.dataComp&&(this.selectedGridViewRowObj=this.gridViewOptions.dataComp.getRowArray(e));var i=this.itemArr[e].label;this._setLabel(e),"input"!=this.options.renderType&&(this.dom.input.style.display="none",this.dom.input.style.visibility="hidden",this.dom.label.style.display="block",this.dom.label.style.visibility="visible",this.dom.input.value=i),this.selectedItem={text:i,value:this.itemArr[e].value,orgLabel:this.itemArr[e].orgLabel},this.itemTable&&("input"!=this.options.renderType?this.render.setAttribute("aria-activedescendant",this.itemTable.id+"_"+e):"input"==this.options.renderType&&this.dom.input.setAttribute("aria-activedescendant",this.itemTable.id+"_option"+(1*e+1)))}else-1==e&&"gridView"===this.itemTableMode&&!1===this.options.selectedData&&"useData"===this.options.noResult?("gridView"==this.itemTableMode&&this.gridViewOptions.dataComp&&(this.selectedGridViewRowObj=this.gridViewOptions.dataComp.getRowArray(e)),this.dom.label.innerHTML=this._domInputValue,this.dom.label.style.display="block",this.dom.label.style.visibility="visible",this.dom.input.value=this._domInputValue,this.selectedItem={text:this._domInputValue},this.itemTable&&this.render.setAttribute("aria-activedescendant",this.itemTable.id+"_"+e)):(this.dom.label.innerHTML="",this.dom.input.value="","input"!=this.options.renderType&&this.showEditMode(!1))}return!0}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype._setLabel=function(e){try{if(this.dom.label){if(e<0||e>=this.getItemCount())return;var t=this.itemArr[e].label+"";if(this.options.customLabelFormatter&&(this.customLabelFormatter=a.Z.getGlobalFunction(this.options.customLabelFormatter,this.scope_id)),"function"==typeof this.customLabelFormatter){var i=this.itemArr[e].value+"",s=this.itemArr[e].orgLabel+"";(0!=e||!0!==this.options.chooseOption&&!0!==this.options.allOption)&&(0!=e&&1!=e||!0!==this.options.chooseOption||!0!==this.options.allOption)&&(t=this.customLabelFormatter.call(this,s,i,this.isOpen)),this.dom.label.innerHTML=t}else{var r=this.options.escape?this._encode(t):t;r=this.getFormattedValue(e,r),"input"==this.options.renderType?this.dom.input.value=r:this.dom.label.innerHTML=r}}}catch(e){n.Y.printStackTrace(e)}},u.prototype._getLabel=function(e){try{if(this.dom.label){var t=this.itemArr[e].label+"";if(this.options.customLabelFormatter&&(this.customLabelFormatter=a.Z.getGlobalFunction(this.options.customLabelFormatter,this.scope_id)),
"function"==typeof this.customLabelFormatter){var i=this.itemArr[e].value+"",s=this.itemArr[e].orgLabel+"";(0!=e||!0!==this.options.chooseOption&&!0!==this.options.allOption)&&(0!=e&&1!=e||!0!==this.options.chooseOption||!0!==this.options.allOption)&&(t=this.customLabelFormatter.call(this,s,i,this.isOpen))}return t}}catch(e){n.Y.printStackTrace(e)}},u.prototype.setDisplayMode=function(e){try{if("label"==e||"value"==e||"value delim label"==e||"label delim value"==e){var t=this.options.displayMode;this.options.displayMode=e,this._initDisplayMode(),t!=this.options.displayMode&&this._refreshItemTable()}}catch(e){n.Y.printStackTrace(e)}},u.prototype.setDelimiter=function(e){try{this.options.delimiter!=e&&(this.options.delimiter=e||"\t","0"!=this.options.displayMode&&"3"!=this.options.displayMode&&this._refreshItemTable())}catch(e){n.Y.printStackTrace(e)}},u.prototype._refreshItemTable=function(){try{this.isOpen&&this.closeSubLayer(),this.setSelectItemArr(),"grid"!=this.itemTableMode&&"gridView"!=this.itemTableMode&&this.itemTable&&this.itemTable.setItemArr(this.itemArr),this._setLabel(this.getSelectedIndex())}catch(e){n.Y.printStackTrace(e)}},u.prototype._getChooseOptionLabel=function(){try{var e=this.options.chooseOptionLabel||this.defaultChooseOptionLabel;if(this.options.useLocale&&this.options.chooseOptionLabelLocaleRef){var t=this.getLocaleValue(this.options.chooseOptionLabelLocaleRef);t&&(e=t)}return e}catch(e){n.Y.printStackTrace(e)}},u.prototype.setAllSelectedIndex=function(e,t){try{return this.allItemArr[e]?(this.selectedIndex=-1,this.selectedAllIndex=e,this.setDummyData(this.allItemArr[e].value,this.allItemArr[e].label+""),t&&this.modelControl.setData(this.allItemArr[e].value),NaN):(this.selectedAllIndex=-1,!1)}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.getSelectedIndex=function(){try{return this.selectedIndex}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.setValue=function(e){try{if(a.Z.isNull(e))return;var t=this.getValue(),i=this.setValueNM(e);1==i?(this.modelControl.setData(e),t!=this.getValue()&&l.f.fireEvent(this,"onchange",{oldValue:t,newValue:this.getValue()})):isNaN(i)?this.modelControl.isBinded()&&this.modelControl.setData(e):this.options.emptyItem?this.setSelectedIndex(-1):-1===this.selectedIndex&&"gridView"===this.itemTableMode&&!1===this.options.selectedData&&"useData"===this.options.noResult?(this._domInputValue=e,this.setSelectedIndex(-1,!0)):this._setValueNotInList(e),this.broadcast({linkedDataList:["refresh",["replace"]]})}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.setValueNM=function(e){try{if(a.Z.isNull(e))return;e=e.toString();var t=this.getItemCount();e&&"gridView"===this.itemTableMode&&!1===this.options.selectedData&&"useData"===this.options.noResult&&(this.selectedIndex=-1);for(var i=0;i<t;i++)if(this.itemArr[i].value==e)return this.setSelectedIndexNM(i),!0;return this.setAllValue(e)}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.setAllValue=function(e,t){try{try{if(!this.modelControl.isDataCollectionItemsetBinded||this.modelControl.dataCollectionItemsetInfo.dataComp&&!this.modelControl.dataCollectionItemsetInfo.dataComp.options.validateAllItemsetData)return!1}catch(e){return!1}if(a.Z.isNull(e))return!1;e=e.toString();for(var i=this.allItemArr.length,s=0;s<i;s++)if(this.allItemArr[s].value==e)return this.setAllSelectedIndex(s,t);return!1}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.getValue=function(){try{if(this.dummyData)return this.dummyData.value;if(this.itemArr[this.selectedIndex])return this.itemArr[this.selectedIndex].value;if(this.options.emptyItem&&-1==this.selectedIndex)return this.options.emptyValue;if("empty"==this.options.returnValueType)return"";var e=null;return"gridView"===this.itemTableMode&&!1===this.options.selectedData&&"useData"===this.options.noResult?this._domInputValue&&(e=this._domInputValue):e=this._getValueNotInList(),e}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype._getValueNotInList=function(){try{
return"keepValue"===this.options.valueNotInList?(null!=this.dom.label.textContent?this.dom.label.textContent:null!=this.dom.label.innerText?this.dom.label.innerText:this.dom.label.innerHTML)||null:this.options.emptyItem&&-1==this.selectedIndex?this.options.emptyValue:null}catch(e){return n.Y.printStackTrace(e,null,this),null}},u.prototype.setText=function(e,t){try{var i=this.getItemCount(),s="";if(t)for(var r=0;r<i;r++)this.itemArr[r].orgLabel==e&&(s=this.itemArr[r].value);else for(r=0;r<i;r++)this.itemArr[r].label==e&&(s=this.itemArr[r].value);this.setValue(s)}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.getText=function(e){try{return this.dummyData?this.dummyData.label:this.itemArr[this.selectedIndex]?e?this.itemArr[this.selectedIndex].orgLabel:this.itemArr[this.selectedIndex].label:null}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.setItem=function(e,t,i,s){try{if(!this.itemArr)return;if(this.itemArr.length<=s)return;this.itemArr[s].label=e,this.itemArr[s].value=t,this.itemArr[s].orgLabel=e,this.itemArr[s].label=this.getItemText(s),this.itemArr[s].xml=i}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.addItem=function(e,t,i,s){try{var r,o=!0;if(e+="",t+="",null==i){var l="<DATA><label>"+WebSquare.xml.encode(e)+"</label><value>"+WebSquare.xml.encode(t)+"</value></DATA>";r=WebSquare.xml.parse(l)}var a={label:e,value:t,orgLabel:e,xml:r};s=parseInt(s,10),(isNaN(s)||s<0||s>=this.getItemCount())&&(s=this.getItemCount());for(var h=0;h<this.itemArr.length;h++)if("all"==this.options.searchTarget){if(this.itemArr[h].value==a.value&&this.itemArr[h].orgLabel==a.orgLabel){o=!1,alert(WebSquare.language.getMessage("AutoComplete_addItem_invalid",this.id,h));break}}else if(this.itemArr[h].value==a.value){o=!1,alert(WebSquare.language.getMessage("AutoComplete_addItem_invalid",this.id,h));break}if(o){void 0===s?("0"!=this.options.displayMode&&(a.label=this.getItemText(s)),this.itemArr.push(a)):(this.itemArr.splice(s,0,a),"0"!=this.options.displayMode&&(this.itemArr[s].label=this.getItemText(s)),s<=this.selectedIndex&&this.setSelectedIndexNM(this.selectedIndex+1)),this.viewArr=[];for(h=0;h<this.itemArr.length;h++)this.viewArr.push({label:this.itemArr[h].label,value:this.itemArr[h].value,orgLabel:this.itemArr[h].orgLabel,index:h,_hidden:this.itemArr[h]._hidden,_disabled:this.itemArr[h]._disabled});return!0}return!1}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.getItem=function(e){try{if(void 0===e)return;if(e>=this.itemArr.length||e<0)return;return this.itemTable&&this.gridOptions.sortIndex&&this.gridItemArr.length>0?this.itemArr[this.itemTable.grid.getRealRowIndex(e)]:this.itemArr[e]}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.getItemCount=function(){try{return this.itemArr.length}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.getSearchedItems=function(){try{return this.viewArr}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.getSelectedRow=function(){try{if("grid"==this.itemTableMode)return this.selectedGridRowObj;if("gridView"==this.itemTableMode)return this.selectedGridViewRowObj;var e={};return e.label=this.selectedItem.orgLabel,e.value=this.selectedItem.value,e}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.onPropertyChange=function(e,t){try{switch(e){case"disabled":var i=this.dom.button;1==t?(this.closeSubLayer(),this.addClass("w2autoComplete_disabled"),null!=i&&this.addClass(i,"w2autoComplete_button_disabled")):(this.removeClass("w2autoComplete_disabled"),null!=i&&this.removeClass(i,"w2autoComplete_disabled"));var s=this.getElementById(this.id+"_input"),r=this.dom.imgArrow&&"BUTTON"==this.dom.imgArrow.tagName;1==t?(s.setAttribute("disabled","disabled"),r&&this.dom.imgArrow.setAttribute("disabled","disabled")):(s.removeAttribute("disabled"),r&&this.dom.imgArrow.removeAttribute("disabled"));break;case"readOnly":1==t?this.addClass("w2autoComplete_readonly"):this.removeClass("w2autoComplete_readonly");s=this.getElementById(this.id+"_input")
;1==t?s.setAttribute("readonly","readonly"):s.removeAttribute("readonly");break;case"mandatory":1==t?this.addClass(this.render,"w2autoComplete_mandatory"):this.removeClass(this.render,"w2autoComplete_mandatory")}}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.setSelectedIndex1=function(e,t,i){try{var s=this.selectedIndex,r=this.getValue();if(!1===l.f.fireEvent(this,"onbeforeselect",this.selectedIndex,e))return;if(this.setSelectedIndex(e,i),s!=this.selectedIndex){var o={oldValue:r,newValue:this.getValue(),oldSelectedIndex:s,newSelectedIndex:this.selectedIndex};l.f.fireEvent(this,"onviewchange",o),"input"==this.options.renderType&&l.f.fireEvent(this,"onafteredit")}t||this.closeSubLayer()}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.validate=function(){try{var e=this.validator.validate(this.getValue());return e||this.focus(),e}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.validateObject=function(){try{var e=this.validator.validate(this.getValue()),t={};return e||(this.focus(),this.validator&&this.validator.obfuscator_invalidObject&&(t.callerId=this.validator.obfuscator_invalidObject.callerId,t.type=this.validator.obfuscator_invalidObject.getType(),t.value=this.validator.obfuscator_invalidObject.getValue())),t}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.showTooltip=function(e,t,i){try{if(!i)return;null!=this.timeShowTooltip&&(clearTimeout(this.timeShowTooltip),this.timeShowTooltip=null),null!=this.timeHideTooltip&&(clearTimeout(this.timeHideTooltip),this.timeHideTooltip=null);var s="";this.options.itemTooltipDisplay&&(s="position:absolute;z-index:10000;");var r=this;this.timeShowTooltip=setTimeout(this.event.bindAsEventListener(this,(function(){try{var l=o.I.getConfiguration("/WebSquare/tooltipShowHideHandler/@value");if(l){var h=a.Z.getGlobalFunction(l,r.scope_id),d=!0;if("function"==typeof h&&(d=h(r)),!d)return}}catch(e){n.Y.printStackTrace(e)}this.tooltip||(this.tooltip=new WebSquare.uiplugin.group(this.id+"_tooltip",{className:"w2autoComplete_tooltip "+this.options.tooltipClass,style:s}),this.tooltip.writeTo(WebSquare.getBody(),null,this.parentFrame),this.tooltip.activate(),this.tooltip.removeClass("w2group")),this.tooltip.setStyle("display","block"),this.tooltip.setStyle("left",e+"px"),this.tooltip.setStyle("top",t+"px"),WebSquare.style.adjustZIndex(this.uuid,this.tooltip.uuid,"toolTip"),this.options.escape&&(i=this._encode(i)),this.tooltip.render.innerHTML=i})),1e3*this.options.tooltipTime)}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.hideTooltip=function(){try{this.timeHideTooltip=setTimeout(this.event.bindAsEventListener(this,(function(){this.tooltip&&this.tooltip.setStyle("display","none")})),1e3*this.options.tooltipTime)}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.setDisableEdit=function(e){this.disableEdit(e)},u.prototype.disableEdit=function(e){try{this.options.disableEdit=a.Z.getBoolean(e),!0===this.options.disableEdit&&this._refreshItemTable()}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.handleClickEvent=function(e){try{if(this.options.disabled)return!1;for(var t=this.event.getTargetIterator(e,this.render);t.next();){if(t.match("w2autoComplete_input")&&this.isOpen)return void this.changeMode();if(t.match("w2autoComplete_col_label")||t.match("w2autoComplete_ul_col_label"))return this.isOpen?this._showItemTableByFocus||"onfocus"===this.options.editModeEvent&&this.viewArr.length<this.itemArr.length||"native"==this.options.renderType||"input"==this.options.renderType||this.closeSubLayer():(1==WebSquare.getBody().getLayerListener().existShow&&WebSquare.getBody().getLayerListener().hideAll(),!0!==this.options.disableEdit&&!1!==this.options.editable||this.openSubLayer()),void(!this.options.disableEdit&&this.options.editable&&this.changeMode({hideListOnFocus:this.options.hideListOnFocus}));t.match("w2autoComplete_col_button")&&(this.mytime&&clearTimeout(this.mytime),
this.isOpen&&(this._showItemTableByFocus||this.viewArr.length<this.itemArr.length)&&this.closeSubLayer())}this.mozTrickBuffer="",this.editmode=!1,this.viewArr=[];for(var i=0;i<this.itemArr.length;i++)this.viewArr.push({label:this.itemArr[i].label,value:this.itemArr[i].value,orgLabel:this.itemArr[i].orgLabel,index:i,_hidden:this.itemArr[i]._hidden,_disabled:this.itemArr[i]._disabled});"onfocus"===this.options.editModeEvent&&!0===this._bOpen&&(this.isOpen=!0,this._bOpen=!1),this.options.useOtherComponentId||this.options.useKeywordHighlight&&this.options.interactionMode&&(this._itemTableRedraw=!0),this.toggle(),t=null}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.handleClickEventDocument=function(e){try{!this.event.isMe(e,this.render)&&this.options.handleOtherClick&&(null!=this.itemTable&&this.itemTable.inputBlurInside&&(o.I.setTimer(this.endEdit,{key:this.id+"_handleClickEventDocument",caller:this,delay:1}),this.itemTable.inputBlurInside=!1),this.mytime&&clearTimeout(this.mytime),this.hideTime&&clearTimeout(this.hideTime),null!=this.itemTable&&0==this.findkeymode?WebSquare.getBody().getLayerListener().isShow(this.id)&&this.closeSubLayer():null!=this.itemTable&&1==this.findkeymode&&(this.findkeymode=!0),this.otherClicked=!0)}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.endEdit=function(e){try{var t,i=this.dom.input.value,s=e&&!0===e.noEvent;l.f.fireEvent(this,"oneditend",i),this.mytime&&window.clearTimeout(this.mytime),this.hideTime&&window.clearTimeout(this.hideTime);var r,h=this.dom.input.value,d=this.options.searchTarget,p=!1;1==this.options.displayMode?(r=h.split(this.options.delimiter),"value"==d?h=r[0]:"label"==d?null!=(h=r[1])&&""!==h||(h=r[0]):"both"==d?r[0]&&r[1]?(h=r[1]+"|"+r[0],p=!0):null!=(h=r[1])&&""!==h||(h=r[0]):"all"==d&&(null==r[1]&&1==r.length&&(r[1]=r[0],r[0]=""),h=r[1]+"|"+r[0])):2==this.options.displayMode&&(r=h.split(this.options.delimiter),"value"==d?null!=(h=r[1])&&""!==h||(h=r[0]):"label"==d||"both"==d?h=r[0]:"all"==d&&(null==r[1]&&(r[1]=""),h=r[0]+"|"+r[1]));var u=this.itemArr[this.selectedIndex];if(null!=(t=null!=u&&(("value"===d||"both"===d)&&h===u.value||("label"===d||"both"===d)&&h===u.orgLabel||"all"===d&&h===u.orgLabel+"|"+u.value)?this.selectedIndex:this.findinItemArr(h,this.options.searchTarget,p)))"useData"!==this.noResult||s?"clear"===this.noResult?s?this.setSelectedIndex(t,!0):this.setSelectedIndex1(t,!0,!0):!0===this.otherClicked?(!0===this.options.handleOtherClick&&this.setSelectedIndex1(t,!0),this.otherClicked=!1):this.setSelectedIndex(t):this.setSelectedIndex1(t,!0);else if("useData"===this.noResult){if(t=1==this.options.allOption||1==this.options.chooseOption?1:0,this.options.ignoreBlankOnNoResult&&""===this.dom.input.value)t=0;else{if("gridView"===this.itemTableMode){var m={label:this.dom.input.value,value:this.dom.input.value,orgLabel:this.dom.input.value};this.dummyGridItemArr.push(m)}"all"===d&&2===r.length?(this.options.interactionMode&&this.dummyItemArr.push({label:r[0],value:r[0],orgLabel:r[0]}),1==this.options.displayMode?this.addItem(r[1],r[0],null,t):this.addItem(r[0],r[1],null,t)):(this.options.interactionMode&&this.dummyItemArr.push({label:this.dom.input.value,value:this.dom.input.value,orgLabel:this.dom.input.value}),this.addItem(this.dom.input.value,this.dom.input.value,null,t))}s?this.setSelectedIndex(t):this.setSelectedIndex1(t,!0)}else"clear"===this.noResult&&(t=1==this.options.allOption||1==this.options.chooseOption?0:-1,s?this.setSelectedIndex(t,!0):this.setSelectedIndex1(t,!0,!0));var c="",b=this.modelControl.isBinded()&&t!==this.getSelectedIndex();null==this.dom.input||null==this.itemArr||-1==this.selectedIndex||b||(this.options.customLabelFormatter&&(this.customLabelFormatter=a.Z.getGlobalFunction(this.options.customLabelFormatter,this.scope_id)),
this.selectedItem.text==this.dom.input.value&&""!=this.dom.input.value?("function"==typeof this.customLabelFormatter?c=this._getLabel(this.selectedIndex):(c=this.options.escape?this._encode(this.selectedItem.text):this.selectedItem.text,c=this.getFormattedValue(this.selectedIndex,c)),this.dom.label.innerHTML=c):this.itemArr&&this.itemArr[this.selectedIndex]?("function"==typeof this.customLabelFormatter?c=this._getLabel(this.selectedIndex):(c=this.options.escape?this._encode(this.itemArr[this.selectedIndex].label):this.itemArr[this.selectedIndex].label,c=this.getFormattedValue(this.selectedIndex,c)),this.dom.label.innerHTML=c,this.selectedItem={text:c,value:this.itemArr[this.selectedIndex].value,orgLabel:this.itemArr[this.selectedIndex].orgLabel}):this.dom.label.innerHTML=""),"input"!=this.options.renderType&&this.showEditMode(!1),this.mozTrickBuffer="",(o.I.browserCheck.moz||o.I.browserCheck.opera)&&(this.findStop=!0,a.Z.clearInterval(this.id+"_mozTrickCompare"))}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.handleblurEventInput=function(e){try{if("native"==this.options.renderType||"input"===this.options.renderType){var t=""===this.options.tabIndex?"0":this.options.tabIndex;this.render.getAttribute("tabIndex")||this.render.setAttribute("tabIndex",t)}if("input"===this.options.renderType){var i=this.getSelectedIndex(),s=this.itemArr[i].label+"",r=this.options.escape?this._encode(s):s;r=this.getFormattedValue(i,r),this.options.emptyItem&&""==this.dom.input.value||(this.dom.input.value=r)}if("none"!=this.dom.input.style.display&&this.options.handleOtherClick&&(null==this.itemTable||null!=this.itemTable&&!this.itemTable.inputBlurInside)&&(this.endEdit(),this.isOpen&&this.closeSubLayer()),this.otherClicked=!1,this.options.blurEventControl){var o=l.f.getRelatedTarget(e),a=o?o.id:"";a!==this.id+"_input"&&a!==this.id+"_itemTable"&&a!==this.id&&l.f.fireEvent(this,"onblur",e)}}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.handleFocusEventInput=function(e){try{l.f.fireEvent(this,"oninputfocus",e)}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.handleKeypressEvent=function(e){try{var t=this.dom.input.value;this.validator.validateKeyPress(this.dom.input,t,e)||l.f.stopEvent(e)}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.handleKeydownEvent=function(e){try{var t=e.charCode?e.charCode:e.keyCode,i=!0;if(!0===this._preventKeyObj[t]||!0===this._preventKeyObj.all)return;if((13==t||this.options.selectByTabKey&&9==t)&&(this.options.disableEdit||!this.editable))return void this.handleClickEvent(e);if(this.event.isMe(e,this.dom.input)){if(this.editmode=!0,this.inputKeyDown(e,!1),(o.I.browserCheck.moz||o.I.browserCheck.opera)&&(this.mozTrickCompare(),a.Z.setInterval(this.mozTrickCompare,{key:this.id+"_mozTrickCompare",caller:this,delay:10})),"native"==this.options.renderType&&9==t&&!e.shiftKey)return;return 9!=t&&13!=t||(i=l.f.fireEvent(this,"oneditenter",e)),void((9==t||13==t&&!0===this.options.nextTabByEnter)&&(this.tabOrderMoveStart=!1,!1!==i&&(e.shiftKey?("native"==this.options.renderType&&this.render.removeAttribute("tabIndex"),null!=WebSquare.tabOrder[this.id]&&null!=WebSquare.tabOrder[this.id].preTabID?(this.tabOrderMoveStart=!0,l.f.preventDefault(e)):"onfocus"===this.options.editModeEvent&&this.focus()):null!=WebSquare.tabOrder[this.id]&&null!=WebSquare.tabOrder[this.id].nextTabID&&(this.tabOrderMoveStart=!0,l.f.preventDefault(e)))))}t=e.charCode?e.charCode:e.keyCode;if(this.options.customToggleKey==t)return void this.toggle();if(o.I.browserCheck.opera){if(18==t&&!this.isOpen)return void this.handleClickEvent(e);if(13==t&&!this.isOpen)return void("native"==this.options.renderType&&e.target.matches(".w2autoComplete_col_button")||this.changeMode())}else{if(!(40!=t&&38!=t||this.isOpen))return this.handleClickEvent(e),void l.f.preventDefault(e);if(13==t&&!this.isOpen)return void("native"==this.options.renderType&&e.target.matches(".w2autoComplete_col_button")||this.changeMode())}
if(9!=t&&13!=t||(i=l.f.fireEvent(this,"oneditenter",e)),(9==t||13==t&&!0===this.options.nextTabByEnter)&&(this.tabOrderMoveStart=!1,!1!==i&&(e.shiftKey?null!=WebSquare.tabOrder[this.id]&&null!=WebSquare.tabOrder[this.id].preTabID&&(this.tabOrderMoveStart=!0,l.f.preventDefault(e)):null!=WebSquare.tabOrder[this.id]&&null!=WebSquare.tabOrder[this.id].nextTabID&&(this.tabOrderMoveStart=!0,l.f.preventDefault(e)))),this.findItemStartedWithKeyChar(e,t),null!=this.itemTable&&this.viewArr.length>0)1==this.isOpen&&(27==t?(this._closeSubLayer(),this.showEditMode(!1),this.focus()):this.itemTable.handleKeydownEvent(e)),this.editmode=!1;else if(null!=this.itemTable&&""==this.itemTable.render.style.display)return;return void(null!=this.itemTable&&this.itemTable.render.style.display)}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.handleKeydownAccessibilityEvent=function(e){try{var t=e.charCode?e.charCode:e.keyCode,i=!0;if(!0===this._preventKeyObj[t]||!0===this._preventKeyObj.all)return;if(13==t&&(this.options.disableEdit||!this.editable))return void this.handleClickEvent(e);if(this.event.isMe(e,this.dom.input)){this.editmode=!0,this.inputKeyDown(e,!1),(o.I.browserCheck.moz||o.I.browserCheck.opera)&&(this.mozTrickCompare(),a.Z.setInterval(this.mozTrickCompare,{key:this.id+"_mozTrickCompare",caller:this,delay:10}));t=e.charCode?e.charCode:e.keyCode;if(40==t||38==t||120==t&&e.ctrlKey||121==t&&e.ctrlKey||120==t||121==t){if(this.isOpen){var s=this.itemTable.getSelectedIndex(),r=s=parseInt(s);if(120==t&&e.ctrlKey||38==t||120==t){if(!0!==this.itemTable.options.noUseUpDownKey){var h=!1;for(r>0?0==--r&&this.itemTable._getCellHidden(r)&&(r--,h=!0):h=!0;r>=0&&(this.itemTable._getCellDisabled(r)||this.itemTable._getCellHidden(r));)r--;r>=0&&this.itemTable.setSelectedIndex(r),this.itemTable._keyIndex=h?-1:r,this.itemTable._directionKeyPressed=!0}}else if((121==t&&e.ctrlKey||40==t||121==t)&&!0!==this.itemTable.options.noUseUpDownKey){var d=this.itemTable.getItemCount();h=!1;for(r+1<d?++r+1==d&&this.itemTable._getCellHidden(r)&&(r++,h=!0):h=!0;r+1<=d&&(this.itemTable._getCellDisabled(r)||this.itemTable._getCellHidden(r));)r++;r<d&&this.itemTable.setSelectedIndex(r),this.itemTable._keyIndex=h?d:r,this.itemTable._directionKeyPressed=!0}}else if(121==t&&e.ctrlKey||40==t||121==t){this.mozTrickBuffer="",this.viewArr=[];for(var p=0;p<this.itemArr.length;p++)this.viewArr.push({label:this.itemArr[p].label,value:this.itemArr[p].value,orgLabel:this.itemArr[p].orgLabel,index:p,_hidden:this.itemArr[p]._hidden,_disabled:this.itemArr[p]._disabled});this.openSubLayer()}return void(this.itemTable&&this.itemTable.selectedCell&&this.dom.input.setAttribute("aria-activedescendant",this.itemTable.selectedCell.id))}if(13==t&&this.editable)return"input"==this.options.renderType&&(i=WebSquare.event.fireEvent(this,"oneditenter",e)),void this.itemTable.handleKeydownEvent(e);if("input"==this.options.renderType&&9==t&&!e.shiftKey)return;return 9!=t&&13!=t||(i=l.f.fireEvent(this,"oneditenter",e)),void((9==t||13==t&&!0===this.options.nextTabByEnter)&&(this.tabOrderMoveStart=!1,!1!==i&&(e.shiftKey?("input"==this.options.renderType&&this.render.removeAttribute("tabIndex"),null!=WebSquare.tabOrder[this.id]&&null!=WebSquare.tabOrder[this.id].preTabID&&(this.tabOrderMoveStart=!0,l.f.preventDefault(e))):null!=WebSquare.tabOrder[this.id]&&null!=WebSquare.tabOrder[this.id].nextTabID&&(this.tabOrderMoveStart=!0,l.f.preventDefault(e)))))}t=e.charCode?e.charCode:e.keyCode;if(this.options.customToggleKey==t)return void this.toggle();if(o.I.browserCheck.opera){if(18==t&&!this.isOpen)return void this.handleClickEvent(e);if(13==t&&!this.isOpen)return void("input"==this.options.renderType&&e.target.matches(".w2autoComplete_col_button")||this.changeMode())}else{if(!(40!=t&&38!=t||this.isOpen))return this.handleClickEvent(e),void l.f.preventDefault(e);if(13==t&&!this.isOpen)return void("input"==this.options.renderType&&e.target.matches(".w2autoComplete_col_button")||this.changeMode())}
if(9!=t&&13!=t||(i=l.f.fireEvent(this,"oneditenter",e)),(9==t||13==t&&!0===this.options.nextTabByEnter)&&(this.tabOrderMoveStart=!1,!1!==i&&(e.shiftKey?null!=WebSquare.tabOrder[this.id]&&null!=WebSquare.tabOrder[this.id].preTabID&&(this.tabOrderMoveStart=!0,l.f.preventDefault(e)):null!=WebSquare.tabOrder[this.id]&&null!=WebSquare.tabOrder[this.id].nextTabID&&(this.tabOrderMoveStart=!0,l.f.preventDefault(e)))),this.findItemStartedWithKeyChar(e,t),null!=this.itemTable&&this.viewArr.length>0)1==this.isOpen&&(27==t?(this._closeSubLayer(),this.showEditMode(!1),this.focus()):this.itemTable.handleKeydownEvent(e)),this.editmode=!1;else if(null!=this.itemTable&&""==this.itemTable.render.style.display)return;return void(null!=this.itemTable&&this.itemTable.render.style.display)}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.handleKeyupEvent=function(e){try{var t,i=e.charCode?e.charCode:e.keyCode;if(!0===this._preventKeyObj[i]||!0===this._preventKeyObj.all)return;if(9==i||13==i&&!0===this.options.nextTabByEnter)if(null!=WebSquare.tabOrder[this.id])if(e.shiftKey){if(null!=WebSquare.tabOrder[this.id].preTabID)(t=a.Z.getPreTabbableComp(this.id))&&this.tabOrderMoveStart&&(this.isOpen&&this.closeSubLayer(),this.tabOrderMoveStart=!1,t.focus(e))}else if(null!=WebSquare.tabOrder[this.id].nextTabID)(t=a.Z.getNextTabbableComp(this.id))&&this.tabOrderMoveStart&&(this.isOpen&&this.closeSubLayer(),this.tabOrderMoveStart=!1,t.focus(e))}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.handleInputKeyupEvent=function(e){try{if(this.editmode){var t=e.charCode?e.charCode:e.keyCode,i={oldValue:this.beforeEditValue,newValue:this.dom.input.value,keyCode:t};this.options.maxByteLength&&l.f.fireEvent(this,"oneditfull");l.f.fireEvent(this,"oneditkeyup",i,e)}}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.handleInputEvent=function(e){try{var t=this.dom.input.value,i=this.validator.validateKeyInput(this.render,t,e);i.valid?this.dom.input.value=i.str:l.f.stopEvent(e)}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.handleArrowFocusInEvent=function(e){try{this.dom.input,e.relatedTarget;this.dom.input!=e.relatedTarget&&!this.options.disableEdit&&this.options.editable&&this.changeMode({noFocus:!0})}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.handleInputFocusEvent=function(e){try{var t="";if(t=-1===this.selectedIndex&&"gridView"===this.itemTableMode&&!1===this.options.selectedData&&"useData"===this.options.noResult?this.selectedItem.text:"value"==this.options.searchTarget?this.selectedItem.value:"label"==this.options.searchTarget||"both"==this.options.searchTarget?this.selectedItem.orgLabel:"all"==this.options.searchTarget?this.selectedItem.text:this.selectedItem.orgLabel,this.dom.input.value=WebSquare.xml.decode(t+""),"select"==this.options.editType)this.dom.input.select();else{this.dom.input.select();var i=this.dom.input.value.length;this.dom.input.setSelectionRange(i,i)}l.f.fireEvent(this,"oninputfocus",e)}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.find=function(e,t){try{var i=this.dom.input.value;if("function"==typeof this.customSearchStrArrFunction)return void this._findInSearchStrArr();if(""==i&&!t)return this.mozTrickBuffer=i,void(null!=this.itemTable&&this.closeSubLayer());if(this.mozTrickBuffer==i)return void(this.mozTrickBuffer=i);this.mozTrickBuffer=i,this.isOpen&&this.closeSubLayer(),this.viewArr=[],this.options.caseSensitive||(i=i.toLowerCase());var s=!1;if(this._showItemTableByFocus&&t)for(var r=0;r<this.itemArr.length;r++)this.viewArr.push({label:this.itemArr[r].label,value:this.itemArr[r].value,orgLabel:this.itemArr[r].orgLabel,index:r,_hidden:this.itemArr[r]._hidden,_disabled:this.itemArr[r]._disabled});else for(r=0;r<this.itemArr.length;r++)if(!this.itemArr[r].noItem){var o=!1;if(this.itemArr[r].orgLabel||(this.itemArr[r].orgLabel=this.itemArr[r].label,this.itemArr[r].label=this.getItemText(r)),
!o&&("label"==this.options.searchTarget||"both"==this.options.searchTarget||"all"==this.options.searchTarget)){var l=this.options.caseSensitive?this.itemArr[r].orgLabel:this.itemArr[r].orgLabel.toLowerCase();"all"==this.options.searchTarget&&(l=this.options.caseSensitive?this.itemArr[r].label:this.itemArr[r].label.toLowerCase()),"contain"==this.search?o=this.myhelper.containWith(l,i):"start"==this.search?o=this.myhelper.startWith(l,i):"none"==this.search&&(o=l==i),l==i&&(s=!0)}if(!o&&("value"==this.options.searchTarget||"both"==this.options.searchTarget||"all"==this.options.searchTarget)){var h=this.options.caseSensitive?this.itemArr[r].value:this.itemArr[r].value.toLowerCase();"contain"==this.search?o=this.myhelper.containWith(h,i):"start"==this.search?o=this.myhelper.startWith(h,i):"none"==this.search&&(o=h==i),h==i&&(s=!0)}var d=this.itemArr[r].label;if(this.options.useKeywordHighlight){var p=this.options.caseSensitive?d:d.toUpperCase(),u=this.options.caseSensitive?this.mozTrickBuffer:this.mozTrickBuffer.toUpperCase(),m=p.indexOf(u);if(m>=0){var c=d.substring(m,m+this.mozTrickBuffer.length);d=d.substring(0,m)+"<span class='w2autoComplete_keyword'>"+c+"</span>"+d.substring(m+this.mozTrickBuffer.length,d.length)}}o&&this.viewArr.push({value:this.itemArr[r].value,label:d,orgLabel:this.itemArr[r].orgLabel,index:r,_hidden:this.itemArr[r]._hidden,_disabled:this.itemArr[r]._disabled})}if(this.options.disabled)return!1;1!==this.viewArr.length&&(s=!1),this.viewArr.length>0?this.isOpen||(1==this.options.allOption&&"gridView"!=this.itemTableMode&&(this.viewArr=[{label:this.defaultAllOptionLabel,value:WebSquare.allValue,orgLabel:this.defaultAllOptionLabel,index:0,noItem:!0}].concat(this.viewArr)),"grid"==this.itemTableMode||"gridView"==this.itemTableMode?this.openSubLayer({noFocus:!0}):("input"==this.options.renderType&&this.itemTable&&this.itemTable.selectedCell&&(this.itemTable.selectedCell=null),this.openSubLayer({select:!1}))):this.closeSubLayer(),this.options.autoFocus&&!0===s&&!0!==e&&a.Z._autoFocus(this)}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype._findInSearchStrArr=function(){try{var e=this.customSearchStrArrFunction.call(this,this.dom.input.value),t=this.dom.input.value;if(this.mozTrickBuffer=t,""==t||e&&e.lengh<1)return void(null!=this.itemTable&&this.closeSubLayer());this.isOpen&&this.closeSubLayer(),this.viewArr=[],this.options.caseSensitive||(t=t.toLowerCase());for(var i=0;i<e.length;i++){t=this.options.caseSensitive?e[i]:e[i].toLowerCase();for(var s=0;s<this.itemArr.length;s++){var r=!1;if(this.itemArr[s].orgLabel||(this.itemArr[s].orgLabel=this.itemArr[s].label,this.itemArr[s].label=this.getItemText(s)),!r&&("label"==this.options.searchTarget||"both"==this.options.searchTarget||"all"==this.options.searchTarget)){var o=this.options.caseSensitive?this.itemArr[s].orgLabel:this.itemArr[s].orgLabel.toLowerCase();"all"==this.options.searchTarget&&(o=this.options.caseSensitive?this.itemArr[s].label:this.itemArr[s].label.toLowerCase()),"contain"==this.search?r=this.myhelper.containWith(o,t):"start"==this.search?r=this.myhelper.startWith(o,t):"none"==this.search&&(r=o==t)}if(!r&&("value"==this.options.searchTarget||"both"==this.options.searchTarget||"all"==this.options.searchTarget)){var l=this.options.caseSensitive?this.itemArr[s].value:this.itemArr[s].value.toLowerCase();"contain"==this.search?r=this.myhelper.containWith(l,t):"start"==this.search?r=this.myhelper.startWith(l,t):"none"==this.search&&(r=l==t)}var a=this.itemArr[s].label;if(this.options.useKeywordHighlight){var h=this.options.caseSensitive?a:a.toUpperCase(),d=this.options.caseSensitive?this.mozTrickBuffer:this.mozTrickBuffer.toUpperCase(),p=h.indexOf(d);if(p>=0){var u=a.substring(p,p+this.mozTrickBuffer.length);a=a.substring(0,p)+"<span class='w2autoComplete_keyword'>"+u+"</span>"+a.substring(p+this.mozTrickBuffer.length,a.length)}}r&&this.viewArr.push({value:this.itemArr[s].value,label:a,orgLabel:this.itemArr[s].orgLabel,index:s,
_hidden:this.itemArr[s]._hidden,_disabled:this.itemArr[s]._disabled})}}if(this.options.disabled)return!1;this.viewArr.length>0?this.isOpen||(1==this.options.allOption&&"gridView"!=this.itemTableMode&&(this.viewArr=[{label:this.defaultAllOptionLabel,value:WebSquare.allValue,orgLabel:this.defaultAllOptionLabel,index:0,noItem:!0}].concat(this.viewArr)),"grid"==this.itemTableMode||"gridView"==this.itemTableMode?this.openSubLayer({noFocus:!0}):this.openSubLayer({select:!1})):this.closeSubLayer()}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.runSubmission=function(e){try{var t=!0,i=this.dom.input.value,s=a.Z.getStringByteSize(i);if(this.options.interactionMinByteLength>0&&this.options.interactionMinByteLength>s&&(t=!1),"false"!=this.options.allowEmptySubmission&&""==i||"default"==this.options.interactionKey&&this.mozTrickBuffer==i&&(t=!1),t)if(this._itemTableRedraw=!0,this.mozTrickBuffer=i,""!=this.options.submissionFunc.wq_trim()){var r=a.Z.getGlobalFunction(this.options.submissionFunc,this.scope_id);"function"==typeof r&&r(i,e)}else if(""!=this.options.submission.wq_trim()){var o="<key>"+WebSquare.xml.encode(i)+"</key>";WebSquare.WebSquaredoc.models[0].rebuild(WebSquare.xml.parse(o),this.options.keyInputRef),WebSquare.WebSquaredoc.models[0].refresh(),WebSquare.ModelUtil.executeSubmission(this.options.submission)}}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.inputKeyDown=function(e,t){try{if(0==t)var i=e.charCode?e.charCode:e.keyCode;if(!("native"!=this.options.renderType&&"input"!=this.options.renderType||37!=i&&38!=i&&39!=i&&40!=i))return;if(this.interactionMode){if(this.editmode=!1,0==t)if("default"==this.options.interactionKey||this.isOpen||this.options.interactionEnterKey){if("native"!=this.options.renderType||9!=i||e.shiftKey)if(40!=i||this.isOpen){if(!(e.shiftKey||38!=i&&33!=i&&40!=i&&34!=i&&35!=i&&36!=i))return o.I.browserCheck.chrome||o.I.browserCheck.safari||a.Z.isIEAllVersion()?(this.mytime&&clearTimeout(this.mytime),this.hideTime&&clearTimeout(this.hideTime)):(o.I.browserCheck.moz||o.I.browserCheck.opera)&&(this.findStop=!0),"grid"!=this.itemTableMode&&"gridView"!=this.itemTableMode&&this.arrowHandle(e),void(WebSquare.getBody().getLayerListener().isShow(this.id)&&("grid"==this.itemTableMode?this.itemTable.setFocusedCell(0,0):this.itemTable.focus()));if(13==i)return void(this.options.interactionEnterKey?this.mytime=this.runSubmission(i):this.enterHandle(e));if(9==i||9==i&&e.shiftKey){if(""==this.dom.input.value||0==this.viewArr.length)return;return"grid"!=this.itemTableMode&&"gridView"!=this.itemTableMode&&this.arrowHandle(e),WebSquare.getBody().getLayerListener().isShow(this.id)&&("grid"==this.itemTableMode||"gridView"==this.itemTableMode?this.itemTable.setFocusedCell(0,0):this.itemTable.focus()),o.I.browserCheck.chrome||o.I.browserCheck.safari||a.Z.isIEAllVersion()?(this.mytime&&clearTimeout(this.mytime),this.hideTime&&clearTimeout(this.hideTime)):(o.I.browserCheck.moz||o.I.browserCheck.opera)&&(this.findStop=!0),this.endEdit(),void(this.isOpen&&this.closeSubLayer())}}else;else if(WebSquare.getBody().getLayerListener().isShow(this.id)&&"grid"!=this.itemTableMode&&"gridView"!=this.itemTableMode)return this.editmode=!1,this.itemTable.inputBlurInside=!0,this.itemTable.setSelectedIndex(0),this._setLabel(this.viewArr[0].index),this.showEditMode(!1),void l.f.preventDefault(e)}else this.options.interactionKey;if(!this.options.interactionEnterKey){var s=this;this.mytime=setTimeout((function(){s.runSubmission(i)}),100)}return}if(0==t)if(40!=i||this.isOpen){if("native"!=this.options.renderType||9!=i||e.shiftKey){if(!(e.shiftKey||38!=i&&33!=i&&40!=i&&34!=i&&35!=i&&36!=i))return o.I.browserCheck.chrome||o.I.browserCheck.safari||a.Z.isIEAllVersion()?(this.mytime&&clearTimeout(this.mytime),this.hideTime&&clearTimeout(this.hideTime)):(o.I.browserCheck.moz||o.I.browserCheck.opera)&&(this.findStop=!0),this.arrowHandle(e),
void(WebSquare.getBody().getLayerListener().isShow(this.id)&&"grid"!=this.itemTableMode&&"gridView"!=this.itemTableMode&&this.itemTable.focus());if(13==i)return void this.enterHandle(e);if(9==i&&this.options.selectByTabKey)return this.enterHandle(e),void WebSquare.event.preventDefault(e);if(9==i||9==i&&e.shiftKey){if(""==this.dom.input.value||0==this.viewArr.length||this.viewArr.length!=this.itemArr.length)return;return this.arrowHandle(e),o.I.browserCheck.chrome||o.I.browserCheck.safari||a.Z.isIEAllVersion()?(this.mytime&&clearTimeout(this.mytime),this.hideTime&&clearTimeout(this.hideTime)):(o.I.browserCheck.moz||o.I.browserCheck.opera)&&(this.findStop=!0),void(this.isOpen&&this.closeSubLayer())}if(27===i)return this.mytime&&clearTimeout(this.mytime),this.hideTime&&clearTimeout(this.hideTime),this.showEditMode(!1),this.focus(),void this.closeTable()}else if(WebSquare.getBody().getLayerListener().isShow(this.id)&&"grid"!=this.itemTableMode&&"gridView"!=this.itemTableMode)return this.editmode=!1,this.itemTable.inputBlurInside=!0,this.itemTable.setSelectedIndex(0),this._setLabel(this.viewArr[0].index),this.showEditMode(!1),void l.f.preventDefault(e)}else if(""==this.dom.input.value.wq_trim())return void this.render.click();if(this.selectedItem={text:"",value:"",orgLabel:""},this.selectedGridRowObj={},this.beforeEditValue=this.dom.input.value,this.itemArr.length>0){s=this;this.mytime=setTimeout((function(){s.find()}),100)}}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.arrowHandle=function(e){try{var t=e.charCode?e.charCode:e.keyCode;if(null==this.itemTable)return;if((this.editmode||this.findkeymode)&&(""==this.dom.input.value||0==this.viewArr.length))return void l.f.stopEvent(e);for(var i=0,s=0;s<this.viewArr.length;s++)if(this.selectedItem.orgLabel==this.viewArr[s].orgLabel){i=s;break}if(9==t||9==t&&e.shiftKey?this.setSelectedIndex1(this.viewArr[i].index):this.itemTable.handleKeydownEvent(e),this.viewArr.length>0){var r="";r="value"==this.options.searchTarget?this.viewArr[i].value:this.viewArr[i].label,this.options.useKeywordHighlight&&(r=r.wq_replaceAll("<span class='w2autoComplete_keyword'>","").wq_replaceAll("</span>","")),this.dom.input.value=r,this.selectedItem={text:r,value:this.viewArr[i].value,orgLabel:this.viewArr[i].orgLabel},this.itemTable.setSelectedIndex(i)}return void(this.mozTrickBuffer="")}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.enterHandle=function(e){try{var t,i=this.dom.input.value;if(l.f.fireEvent(this,"oneditend",i),(null==this.itemTable||null==this.itemTable.selectedCell)&&(null!=this.itemTable||this.options.useOtherComponentId||this.setSubLayer(),null==this.itemTable.selectedCell)){var s=this.findinItemArr(this.dom.input.value,this.options.searchTarget);if("clear"===this.noResult);else if("previous"===this.noResult)1==this.interactionMode&&void 0===s&&(s=-1),this.setSelectedIndex1(s,!0,!0);else if("noEnd"===this.noResult){if(void 0===s)return;this.setSelectedIndex1(s,!0)}else"useData"===this.noResult||"first"===this.noResult&&(this.viewArr.length>0?(t=null==s?this.findinItemArr(this.viewArr[0].value,"value"):s,this.setSelectedIndex1(t,!0)):0!=this.dom.input.value&&void 0!==this.findinItemArr(this.dom.input.value,"value")||this.itemArr.length>0&&(t=this.findinItemArr(this.itemArr[0].value,"value"),this.setSelectedIndex1(t,!0)))}if(o.I.browserCheck.opera&&l.f.stopEvent(e),this.mozTrickBuffer="",null!=this.itemTable.selectedCell)if(t=this.findinItemArr(this.dom.input.value,this.options.searchTarget),"clear"===this.noResult);else if("previous"===this.noResult)1==this.interactionMode?(void 0===t&&(t=-1),this.setSelectedIndex1(t,!0,!0)):(void 0===t&&void 0===(t=this.itemTable.selectedCell.index)&&(t=this.itemTable.selectedCell.getAttribute("index")),this.setSelectedIndex1(t,!0));else if("noEnd"===this.noResult){if(void 0===t)return;this.setSelectedIndex1(t,!0)
}else"useData"===this.noResult||"first"===this.noResult&&(this.viewArr.length>0?(null==t&&(t=this.findinItemArr(this.viewArr[0].value,"value")),this.setSelectedIndex1(t,!0)):0!=this.dom.input.value&&void 0!==this.findinItemArr(this.dom.input.value,"value")||this.itemArr.length>0&&(t=this.findinItemArr(this.itemArr[0].value,"value"),this.setSelectedIndex1(t,!0)));this.mytime&&clearTimeout(this.mytime),this.hideTime&&clearTimeout(this.hideTime),"native"===this.options.renderType?this.isOpen?this.viewArr&&1==this.viewArr.length?(this.closeTable(),this.focus()):(this.showEditMode(!1),this.focus(),this.closeTable()):(this.showEditMode(!1),this.isOpen=!0,this.focus(),this.isOpen=!1):"input"===this.options.renderType?this.isOpen?(this.viewArr&&this.viewArr.length,this.closeTable()):this.dom.input.blur():(this.showEditMode(!1),this.closeTable(),this.focus())}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.findinItemArr=function(e,t,i,s){try{var r=t||"label";function m(e,t){return t&&"string"==typeof e?e.toLowerCase():e}for(var o=s&&!0===s.ignoreCaseSensitive,l=m(e,o),a=0;a<this.itemArr.length;a++)if(!0!==this.itemArr[a]._disabled){var h=m(this.itemArr[a].value,o),d=m(this.itemArr[a].label,o),p=m(this.itemArr[a].orgLabel,o);if("value"===r){if(l==h)return a}else if("label"===r){if(1==this.options.displayMode||2==this.options.displayMode){if(l==p)return a}else if(l==d)return a}else if("both"===r){if(1==i){if(l==p+"|"+h)return a;var u=this.dom.input.value;if(u===d||u===p||u===h)return a}else if(l==p||l==h)return a}else if("all"===r&&l==p+"|"+h)return a}if(!this.options.caseSensitive&&!o)return this.findinItemArr(e,t,i,{ignoreCaseSensitive:!0});if(this.dummyData&&(("value"===r||"both"===r)&&this.dummyData.value||("label"===r||"both"===r)&&e===this.dummyData.label||"all"===r&&e===this.dummyData.label+"|"+this.dummyData.value))return NaN}catch(c){n.Y.printStackTrace(c,null,this)}},u.prototype.closeTable=function(){try{this.closeSubLayer()}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.showTable=function(){try{this.openSubLayer({select:!1})}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.handleMousewheelEvent=function(e){try{if(this.options.preventWheelEvent)return;if(l.f.stopEvent(e),!this.options.useMousewheel)return;for(var t=this.event.getTargetIterator(e,this.render);t.next();)if(t.match("w2autoComplete_selected"))if(this.isOpen){if("grid"!=this.itemTableMode&&"gridView"!=this.itemTableMode){if(this.itemTable.selectedCell)void 0===(i=this.itemTable.selectedCell.index)&&(i=this.itemTable.selectedCell.getAttribute("index"),this.dom.input.value=this.viewArr[i].label),this.itemTable.setSelectedIndex(i)}}else{var i=this.getSelectedIndex();e.wheelDelta>0||e.detail<0?this.setSelectedIndex1(i-1):this.setSelectedIndex1(i+1)}t=null}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.handleFocusEvent=function(e){try{if(l.f.stopEvent(e),!this.isOpen){if("native"==this.options.renderType||"input"==this.options.renderType)this.addClass("w2autoComplete_selected");else{var t=document.getElementById(this.id+"_main_tbody");this.addClass(t,"w2autoComplete_selected"),this.addClass("w2autoComplete_body_selected")}"onfocus"!=this.options.editModeEvent&&"native"!=this.options.renderType&&"input"!=this.options.renderType||!0===this.options.disableEdit||!1===this.options.editable||!0===this._focusSkip&&"input"!==this.options.renderType||this.changeMode({skipFind:this._skipFind})}this.onchangeFlag&&(this.onchangeFlag=!1,l.f.fireEvent(this,"onafteredit")),this._focusSkip=!1,this._skipFind=!1}catch(e){this._focusSkip=!1,this._skipFind=!1,n.Y.printStackTrace(e,null,this)}},u.prototype.handleBlurEvent=function(e){try{if(l.f.stopEvent(e),!this.isOpen)if("native"==this.options.renderType||"input"==this.options.renderType)this.removeClass("w2autoComplete_selected");else{var t=document.getElementById(this.id+"_main_tbody");this.removeClass(t,"w2autoComplete_selected"),this.removeClass("w2autoComplete_body_selected")}
if(this.options.blurEventControl){var i=l.f.getRelatedTarget(e),s=i?i.id:"";s!==this.id+"_input"&&s!==this.id+"_itemTable"&&s!==this.id&&l.f.fireEvent(this,"onblur",e)}}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.handleMouseoverEvent=function(e){try{if(l.f.stopEvent(e),!a.Z.isIE(6)&&!this.isOpen){var t=document.getElementById(this.id+"_main_tbody");"native"==this.options.renderType||"input"==this.options.renderType?this.addClass("w2autoComplete_selected"):(this.addClass(t,"w2autoComplete_selected"),this.addClass("w2autoComplete_body_selected"))}if(!this.isOpen){for(var i=this.event.getTargetIterator(e,this.render);i.next();)if((i.match("w2autoComplete")||i.match("w2autoComplete_acc"))&&!(1!=this.options.tooltipDisplay||this.editmode&&this.event.isMe(e,this.dom.input))){var s,r=i.getElement(),o=WebSquare.style.getAbsoluteLeft(r)+20,h=WebSquare.style.getAbsoluteTop(r)+this.render.offsetHeight+3;s="input"==this.options.renderType?this.dom.input.value:this.dom.label.innerHTML,this.showTooltip(o,h,s)}i=null}}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.handleMouseoutEvent=function(e){try{if(l.f.stopEvent(e),1==this.options.tooltipDisplay&&this.hideTooltip(),!this.isOpen)if("native"==this.options.renderType||"input"==this.options.renderType)this.removeClass("w2autoComplete_selected");else{var t=document.getElementById(this.id+"_main_tbody");this.removeClass(t,"w2autoComplete_selected"),this.removeClass("w2autoComplete_body_selected")}}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.handleMouseleaveEvent=function(e){try{var t=this.render.offsetHeight-1,i=this.render.offsetWidth-1,s=this.getAbsolutePosition("top"),r=this.getAbsolutePosition("left");this.isOpen&&("up"==this.itemTableDirection?(e.clientX<r||e.clientX>r+i||e.clientY>s||e.clinetY>s+t)&&this.closeSubLayer():(e.clientX<r||e.clientX>r+i||e.clientY<s||e.clinetY>s+t)&&this.closeSubLayer())}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.changeMode=function(e){try{if(!1===this.options.editable)return;if(void 0!==e&&null!=e||(e={}),this.editmode=!0,this.findStop=!1,"block"!=this.dom.input.style.display){var t="";if(t=-1===this.selectedIndex&&"gridView"===this.itemTableMode&&!1===this.options.selectedData&&"useData"===this.options.noResult||"both"===this.options.searchTarget&&this.options.displayModeSync?this.selectedItem.text:"value"==this.options.searchTarget?this.selectedItem.value:"label"==this.options.searchTarget||"both"==this.options.searchTarget?this.selectedItem.orgLabel:"all"==this.options.searchTarget?this.selectedItem.text:this.selectedItem.orgLabel,"focus"==this.options.editType){this.showEditMode(!0),document.activeElement!=this.dom.input&&!0!==e.noFocus&&this.setfFocus();var i=WebSquare.xml.decode(t+"");this.dom.input.value=i,(a.Z.isOpera()||a.Z.isFF())&&this.dom.input.setSelectionRange(i.length,i.length)}else this.dom.input.value=WebSquare.xml.decode(t+""),this.showEditMode(!0),!0!==e.noFocus&&"input"!==this.options.renderType&&(this.dom.input.select(),this.setfFocus())}if("input"===this.options.renderType&&!0!==e.noFocus&&("select"==this.options.editType&&this.dom.input.select(),this.setfFocus()),!this.interactionMode&&"native"!=this.options.renderType&&"input"!=this.options.renderType&&!0!==e.noFocus&&!0!==e.skipFind&&this.itemArr.length>0&&!0!==e.hideListOnFocus){var s=this;(this._showItemTableByFocus||this.dom.input.value&&this.dom.input.value!==this.defaultAllOptionLabel&&this.dom.input.value!==this._getChooseOptionLabel())&&(this.mytime&&clearTimeout(this.mytime),this.mytime=setTimeout((function(){s.find(!0,!0)}),100))}}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.showEditMode=function(e){e?(this.dom.label.style.display="none",this.dom.label.style.visibility="hidden",this.dom.input.style.display="block",this.dom.input.style.visibility="visible"):o.I.setTimer((function(){try{this.dom.input.style.display="none",this.dom.input.style.visibility="hidden",this.dom.label.style.display="block",
this.dom.label.style.visibility="visible"}catch(e){n.Y.printStackTrace(e,null,this)}}),{key:this.id+"_showEditMode",caller:this,delay:1})},u.prototype.setfFocus=function(){try{this.dom.input.focus(),null!=this.itemTable&&(this.itemTable.inputBlurInside=!1)}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.setDisabled=function(e){try{e=a.Z.getBoolean(e),this.options.disabled=e,this.setProperty("disabled",e),!0===e?this.render.removeAttribute("tabIndex"):this.render.setAttribute("tabIndex",this.options.tabIndex||0)}catch(e){n.Y.printStackTrace(e)}return e},u.prototype.mozTrickCompare=function(){try{this.dom.input.value!=this.trickBuffer&&(this.trickBuffer=this.dom.input.value,0==this.findStop&&this.inputKeyDown({},!0))}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.setInputFocus=function(){try{this.changeMode()}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.setEditMode=function(){try{this.setInputFocus()}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.removeAll=function(e){try{if(this.selectedItem={text:"",value:"",orgLabel:""},this.itemArr=new Array,e&&(1==this.options.allOption&&(this.itemArr=[{label:this.defaultAllOptionLabel,value:WebSquare.allValue,orgLabel:this.defaultAllOptionLabel,noItem:!0}].concat(this.itemArr)),1==this.options.chooseOption)){var t=this._getChooseOptionLabel();this.itemArr=[{label:t,value:this.options.chooseOptionValue,orgLabel:t,noItem:!0}].concat(this.itemArr)}if(this.setSelectOptions(this.itemArr),this.itemArr.length>0?this.dom.label.innerHTML=this.options.escape?this._encode(this.itemArr[0].label):this.itemArr[0].label:this.dom.label.innerHTML="","grid"==this.itemTableMode)this.viewArr=[],this.gridItemArr=[],this.gridRowItemArr=[],this.selectedGridRowObj={},this.itemTable&&this.itemTable.grid.removeAll();else if("gridView"==this.itemTableMode){if(this.viewArr=[],this.gridViewItemArr=[],this.gridViewRowItemArr=[],this.selectedGridViewRowObj={},this.itemTable)this.modelControl.getDataComp(this.itemTable.gridView.options.dataList).removeAll()}}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.initAutoComplete=function(){try{this.removeAll(),this.selectedIndex=-1,this.selectedItem={text:"",value:"",orgLabel:""},this.viewArr=[],this.dom.input.value="",this.dummyData=null,this._itemTableRedraw=!0,this.isOpen&&this.closeSubLayer(),this.broadcast({linkedDataList:["refresh"]})}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.hide=function(){try{this.closeSubLayer(),h.q.prototype.hide.call(this)}catch(e){n.Y.printStackTrace(e)}},u.prototype.getFormattedValue=function(e,t){try{var i=t;return this.options.displayFormatter&&(this.displayFormatter||(this.fixedIndex=-1,1==this.options.allOption&&this.fixedIndex++,1==this.options.chooseOption&&this.fixedIndex++,this.displayFormatter=a.Z.getGlobalFunction(this.options.displayFormatter,this.scope_id)),"function"==typeof this.displayFormatter&&e>this.fixedIndex&&(i=this.displayFormatter(t))),i}catch(e){n.Y.printStackTrace(e)}},u.prototype.findItemStartedWithKeyChar=function(e,t){try{if(!1===this.options.useFindItemFirstKeyChar)return;var i=this.keyCharHash[t],s=-1;if(i){var r=this.korCharHash[t],o=this.korCharHash2[t],l=this.selectedIndex;this.options.findItem?(this._keyBuffer+=i,l=0):(this._keyBuffer=i,l++);for(var h=1;;)if(l%=this.itemArr.length,!0!==this.itemArr[l]._hidden){var d=this.itemArr[l].label.toLowerCase();if(0!=l||!0!==this.options.chooseOption&&!0!==this.options.allOption)if(0!=l&&1!=l||!0!==this.options.chooseOption||!0!==this.options.allOption){var p=!1;r&&!e.shiftKey?p=this.myhelper.startWith(d,r):o&&e.shiftKey&&(p=this.myhelper.startWith(d,o));var u=this.options.findItem?this._keyBuffer:i;if(d.startsWith(u)||p&&a.Z.getBoolean(this.options.findItemKor)){s=l;break}if(d.startsWith(u)){this._keyBuffer="",s=l;break}if(h>this.itemArr.length)break;l++,h++}else{if(this.itemArr.length<=2)break;l++}else{if(this.itemArr.length<=1)break;l++}}else l++;if(s>-1)return this.setSelectedIndex1(s),!0}
if(-1==s)return this._keyBuffer="",!1}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.setRef=function(e){try{this.modelControl.isBinded()||(this.modelControl.useRef=!0),this.options.ref=e,this.modelControl.setRef(e),this.refresh()}catch(e){n.Y.printStackTrace(e)}},u.prototype.focusNextTabOrder=function(){try{if(null!=WebSquare.tabOrder[this.id]&&null!=WebSquare.tabOrder[this.id].nextTabID){var e=a.Z.getNextTabbableComp(this.id);e&&(this.endEdit(),this.isOpen&&this.closeSubLayer(),e.focus())}}catch(e){n.Y.printStackTrace(e)}},u.prototype.focusPreTabOrder=function(){try{if(null!=WebSquare.tabOrder[this.id]&&null!=WebSquare.tabOrder[this.id].preTabID){var e=a.Z.getPreTabbableComp(this.id);e&&(this.endEdit(),this.isOpen&&this.closeSubLayer(),e.focus())}}catch(e){n.Y.printStackTrace(e)}},u.prototype.unbindRef=function(){try{this.modelControl.isBinded()&&(this.options.ref="",this.modelControl.unbindRef(),this.refresh())}catch(e){n.Y.printStackTrace(e)}},u.prototype.setGridData=function(){this.itemTable.grid.clearFilter(),this.itemTable.grid.setTopRowIndex(0);var e=this.itemsetObj.labelId,t=this.itemsetObj.valueId;if(!this.options.interactionMode)if(this.gridItemArr=[],this.gridOptions.dataComp){var i=this.itemTable.grid.getColCnt();if(this.gridOptions.dataComp.getColumnCount()!=i){var s,r=[],o={},n=[];for(var l in this.itemTable.grid.cellInfoHash)r.push(this.itemTable.grid.cellInfoHash[l].id);if(s=this.gridOptions.dataComp.getColData(r[0]).length,null==this.gridOptions.dataComp.sortStatusArr){for(var a=0;a<r.length;a++)o[r[a]]=this.gridOptions.dataComp.getColData(r[a]);for(var h=0;h<s;h++)for(var l in n[h]={},o)n[h][l]=o[l][h];for(l=0;l<this.viewArr.length;l++)for(a=0;a<n.length;a++)if(this.viewArr[l].orgLabel===n[a][this.itemsetObj.label]&&this.viewArr[l].value===n[a][this.itemsetObj.value]){var d=[];for(var p in n[a])d.push(n[a][p]);this.gridItemArr=this.gridItemArr.concat(d);break}}}else for(l=0;l<this.viewArr.length;l++)for(a=0;a<this.itemArr.length;a++)if(this.viewArr[l].orgLabel===this.itemArr[a].label&&this.viewArr[l].value===this.itemArr[a].value){this.gridItemArr=this.gridItemArr.concat(this.gridOptions.dataComp.getRowData(a));break}}else for(l=0;l<this.viewArr.length;l++)for(a=0;a<this.gridRowItemArr.length;a++)if(this.viewArr[l].orgLabel===this.gridRowItemArr[a][e]&&this.viewArr[l].value===this.gridRowItemArr[a][t]){for(var u in this.gridRowItemArr[a])this.gridItemArr.push(this.gridRowItemArr[a][u]);break}if(this.itemTable.grid.setData(this.gridItemArr.slice(0)),this.options.allOption){var m=[],c=-1;for(a=0;a<this.itemsetObj.items.length;a++)-1==c&&this.itemsetObj.items[a].ref==this.itemsetObj.label&&(c=a),m.push("");m[-1==c?0:c]=this.defaultAllOptionLabel,this.itemTable.grid.setRowData(0,m,!1)}if(this.gridOptions.sortIndex&&this.gridItemArr.length>0){var b=[];if(this.options.allOption){var f=this.gridOptions.sortIndex.split(" ")[0],y=this.itemTable.grid.getCellInfo(f).options.dataType,v=parseInt(this.gridOptions.sortOrder.split(" ")[0],10);b[0]=function(e,t,i,s){return 0==i?-1:0==s?1:("number"==y?(e=Number(e),t=Number(t)):(e=e||"",t=t||""),e>t?1*v:e<t?-1*v:0)}}this.itemTable.grid.multisort({sortIndex:this.gridOptions.sortIndex,sortOrder:this.gridOptions.sortOrder,sortFuncArr:b})}else{var g=this.gridItemArr.length>0&&this.itemTable.grid.delayedDrawObj&&this.itemTable.render&&"none"===this.itemTable.render.style.display;g&&this.itemTable.show(),this.itemTable.grid.notifyDataChanged({keepTop:!0}),g&&this.itemTable.hide()}},u.prototype.setGridViewData=function(){this.itemTable.gridView.setTopRowIndex(0);var e=null;if((e=this.modelControl.getDataComp(this.itemTable.gridView.options.dataList)).removeAll(),e.setData(this.gridViewOptions.dataComp.getAllFilteredData()),this.options.allOption||this.options.chooseOption){for(var t=[],i=-1,s=0;s<this.itemsetObj.items.length;s++)-1==i&&this.itemsetObj.items[s].ref==this.itemsetObj.label&&(i=e.bodyIdColIndexMap[this.itemsetObj.label]),t.push("")
;this.options.allOption&&(t[-1==i?0:i]=this.defaultAllOptionLabel,e.setRowData(0,t,!1)),this.options.chooseOption&&(t[-1==i?0:i]=this._getChooseOptionLabel(),e.setRowData(0,t,!1))}if(this.dummyGridItemArr.length>0){var r=0;this.options.allOption&&r++,this.options.chooseOption&&r++;t=[],i=-1;var o=e.bodyIdColIndexMap[this.itemsetObj.value];for(s=0;s<this.itemsetObj.items.length;s++)-1==i&&this.itemsetObj.items[s].ref==this.itemsetObj.label&&(i=e.bodyIdColIndexMap[this.itemsetObj.label]),t.push("");for(var n=0;n<this.dummyGridItemArr.length;n++)t[-1==i?0:i]=this.dummyGridItemArr[n].label,t[-1==o?1:o]=this.dummyGridItemArr[n].value,e.setRowData(r,t,!1)}if(!this.options.interactionMode){if(this.viewArr&&0==this.viewArr.length)for(n=0;n<this.itemArr.length;n++)this.viewArr.push({label:this.itemArr[n].label,value:this.itemArr[n].value,orgLabel:this.itemArr[n].orgLabel,index:n,_hidden:this.itemArr[n]._hidden,_disabled:this.itemArr[n]._disabled});if(this.gridViewItemArr=[],this.gridViewOptions.dataComp)if(this.viewArr.length===this.itemArr.length)this.gridViewItemArr=this.gridViewItemArr.concat(e.dataArr);else for(n=0;n<this.viewArr.length;n++)for(s=0;s<this.itemArr.length;s++)if(this.viewArr[n].orgLabel===this.itemArr[s].orgLabel&&this.viewArr[n].value===this.itemArr[s].value){for(var l=e.getRowData(s),a=0;a<l.length;a++)this.gridViewItemArr.push(l[a]);break}}e.setData(this.gridViewItemArr.slice(0)),this.options.interactionMode&&(this.options.allOption&&(t[-1==i?0:i]=this.defaultAllOptionLabel,e.setRowData(0,t,!1)),this.options.chooseOption&&(t[-1==i?0:i]=this._getChooseOptionLabel(),e.setRowData(0,t,!1)));for(n=0;n<this.viewArr.length;n++)this.viewArr[n]._hidden?this.itemTable.gridView.setRowVisible(n,!1):this.itemTable.gridView.setRowVisible(n,!0);if(this.gridViewOptions.sortIndex&&this.gridViewItemArr.length>0){var h=[];if(this.options.allOption){var d=this.gridViewOptions.sortIndex.split(" ")[0],p=this.itemTable.gridView.getCellInfo(d).options.dataType,u=parseInt(this.gridViewOptions.sortOrder.split(" ")[0],10);h[0]=function(e,t,i,s){return 0==i?-1:0==s?1:("number"==p?(e=Number(e),t=Number(t)):(e=e||"",t=t||""),e>t?1*u:e<t?-1*u:0)}}this.itemTable.gridView._dataList.multisort({sortIndex:this.gridViewOptions.sortIndex,sortOrder:this.gridViewOptions.sortOrder,sortFuncArr:h})}else{var m=this.gridViewItemArr.length>0&&this.itemTable.gridView.delayedDrawObj&&this.itemTable.render&&"none"===this.itemTable.render.style.display;m&&this.itemTable.show(),this.itemTable.gridView.notifyDataChanged({keepTop:!0}),m&&this.itemTable.hide()}},u.prototype.setDummyData=function(e,t){this.dummyData={value:e,label:t},this.selectedIndex=-1,"input"!=this.options.renderType&&this.showEditMode(!1),this.selectedItem={text:t,value:e,orgLabel:t};var i=this.options.escape?this._encode(t):t;this.dom.label.innerHTML=i,this.dom.input.value=t},u.prototype.setStyle=function(e,t){try{if(!this.render)return;WebSquare.style.setStyle(this.render,e,t),"font-size"==e&&(this.dom.label.style[e]=t)}catch(e){n.Y.printStackTrace(e)}},u.prototype.changeChooseOption=function(e,t){try{var i=-2;if(!0===this.options.chooseOption){i=-1;for(var s=this.getItemCount(),r=0;r<s;r++)if(this.itemArr[r].value===this.options.chooseOptionValue){i=r;break}i>-1&&this.itemArr.splice(i,1)}this.options.chooseOption=!0,this.options.chooseOptionValue=e,this.options.chooseOptionLabel=t,this.itemArr=[{label:t,value:e,orgLabel:t}].concat(this.itemArr),this.itemTable?(this.itemTable.setStyle("visibility","hidden"),this.itemTable.setStyle("display","block"),this.setSelectOptions(this.itemArr),this.itemTable.setStyle("display","none")):this.setSelectOptions(this.itemArr);var o=this.getSelectedIndex();i!==o&&-1!==o||this.setSelectedIndex(0)}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.serialize=function(){return{selectedIndex:this.getSelectedIndex()}},u.prototype.restore=function(e){try{return this.setSelectedIndex(e.selectedIndex),!0}catch(e){return n.Y.printStackTrace(e,null,this),!1}},
u.prototype.setItemTableFocus=function(){try{WebSquare.getBody().getLayerListener().isShow(this.id)&&this.itemTable.focus()}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype._encode=function(e){var t=e;try{if("string"!=typeof e)return t;var i="<span class='w2autoComplete_keyword'>",s="</span>",r=e.indexOf(i),o=e.indexOf(s,37);return t=this.options.useKeywordHighlight&&r>=0&&o>=0&&e.slice(r,r+37)===i&&e.slice(o,o+7)===s?e.slice(0,r)+i+WebSquare.xml._encode(e.slice(r+37,o))+s+WebSquare.xml._encode(e.slice(o+7)):WebSquare.xml._encode(e)}catch(e){return n.Y.printStackTrace(e,null,this),t}},u.prototype.stopRefreshItemTable=function(e){try{this.refreshStopItemTable=a.Z.getBoolean(e)}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype._getVisibleItemCountViewArr=function(){try{for(var e=0,t=0;t<this.viewArr.length;t++)!0!==this.viewArr[t]._hidden&&e++;return e}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.setSetting=function(){try{if(!this.render||"native"!=this.options.renderType&&"input"!=this.options.renderType)return;var e,t,i=WebSquare.style.getStyle(this.render,"width"),s=WebSquare.style.getStyle(this.dom.divArrow,"width");if(s=s.lastIndexOf("px")>-1?Math.ceil(1*s.wq_replaceAll("px","")):0,(i="auto"==i?"100%":i).lastIndexOf("px")>-1)r=(r=WebSquare.style.getStyle(this.dom.divInput,"padding-right")).lastIndexOf("px")>-1?parseInt(r,10):0,i=parseInt(i.wq_replaceAll("px",""),10)-s-r;else if(i.lastIndexOf("%")>-1&&this.parentControl){if(T=this.parentControl.render?this.parentControl.render:document.getElementById(this.parentControl.id)){var r,o=WebSquare.style.getStyle(T,"padding-left"),l=WebSquare.style.getStyle(T,"padding-right"),a=WebSquare.style.getStyle(T,"border-left-width"),h=WebSquare.style.getStyle(T,"border-right-width");o=o.lastIndexOf("px")>-1?parseInt(o,10):0,l=l.lastIndexOf("px")>-1?parseInt(l,10):0,a=a.lastIndexOf("px")>-1?parseInt(a,10):0,h=h.lastIndexOf("px")>-1?parseInt(h,10):0,r=(r=WebSquare.style.getStyle(this.dom.divInput,"padding-right")).lastIndexOf("px")>-1?parseInt(r,10):0,i=(T.offsetWidth-(o+l+a+h))*parseInt(i.wq_replaceAll("%",""),10)/100-s-r}}var d=WebSquare.style.getStyle(this.dom.input,"border-right-width");d=(d=1*d.wq_replaceAll("px",""))>1?parseInt(d,10):Math.ceil(d);var p=WebSquare.style.getStyle(this.dom.input,"border-left-width");p=(p=1*p.wq_replaceAll("px",""))>1?parseInt(p,10):Math.ceil(p);var u=WebSquare.style.getStyle(this.dom.input,"border-top-width");u=(u=1*u.wq_replaceAll("px",""))>1?parseInt(u,10):Math.ceil(u);var m=WebSquare.style.getStyle(this.dom.input,"border-bottom-width");m=(m=1*m.wq_replaceAll("px",""))>1?parseInt(m,10):Math.ceil(m);var c=WebSquare.style.getStyle(this.dom.input,"padding-right");c=(c=1*c.wq_replaceAll("px",""))>1?parseInt(c,10):Math.ceil(c);var b=WebSquare.style.getStyle(this.dom.input,"padding-left");b=(b=1*b.wq_replaceAll("px",""))>1?parseInt(b,10):Math.ceil(b);var f=WebSquare.style.getStyle(this.dom.input,"padding-top");f=(f=1*f.wq_replaceAll("px",""))>1?parseInt(f,10):Math.ceil(f);var y,v=WebSquare.style.getStyle(this.dom.input,"padding-bottom");v=(v=1*v.wq_replaceAll("px",""))>1?parseInt(v,10):Math.ceil(v),e=i-(d+p+c+b),WebSquare.style.setStyle(this.dom.divInput,"width",Math.max(i,0)+"px"),WebSquare.style.setStyle(this.dom.input,"width",Math.max(e,0)+"px");var g=WebSquare.style.getStyle(this.render,"height");if((g="auto"==g?this.render.offsetHeight+"px":g).lastIndexOf("px")>-1)g=parseInt(g.wq_replaceAll("px",""),10);else if(g.lastIndexOf("%")>-1){var T;if(T=this.parentControl.render?this.parentControl.render:document.getElementById(this.parentControl.id))g=T.offsetHeight*parseInt(g.wq_replaceAll("%",""),10)/100}t=g-(u+m+f+v);var w=parseInt(WebSquare.style.getStyle(this.dom.imgArrow,"height"),10);y=w>0?(g-w)/2:(g-16)/2,(WebSquare.util.isIE(6)||WebSquare.util.isIE(7))&&(t-=2),WebSquare.style.setStyle(this.dom.imgArrow,"top",Math.max(y,0)+"px"),WebSquare.style.setStyle(this.dom.divInput,"height",Math.max(g,0)+"px"),
WebSquare.style.setStyle(this.dom.input,"height",Math.max(t,0)+"px"),this.resizeObj.offsetWidth=this.render.offsetWidth,this.resizeObj.offsetWidth=this.render.offsetHeight}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.checkResize=function(){try{if(!this.render)return;var e=this.render.offsetWidth,t=this.render.offsetHeight,i=window.innerHeight,s=i-this.resizeObj.innerHeight;if(e>0&&t>0)if(0==this.resizeObj.width&&0==this.resizeObj.height);else if(0!=s)this.itemTable&&this._setItemTableBody(this._direction,this._tdHeight);else{var r=e-this.resizeObj.width,o=t-this.resizeObj.height;0==r&&0==o||this.setSetting()}this.resizeObj={width:e,height:t,innerHeight:i}}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype._setSize=function(e,t){try{WebSquare.style.setSize.call(this,this.render,e,t),this.setSetting()}catch(e){n.Y.printStackTrace(e)}},u.prototype.handleMousedownEvent=function(e){try{if("onfocus"===this.options.editModeEvent)for(var t=this.event.getTargetIterator(e,this.render);t.next();)t.match("w2autoComplete_col_button")&&(!0===this.isOpen&&(this._bOpen=!0),this._skipFind=!0,t.stop());l.f.stopPropagation(e)}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.focus=function(){try{this._focusSkip=!0,h.q.prototype.focus.call(this)}catch(e){n.Y.printStackTrace(e,null,this)}},u.prototype.setAllowChar=function(e){this._setCharRule("allowChar",e)},u.prototype._setCharRule=function(e,t){try{if(a.Z.isNull(t))return!1;if(this.options[e]!==t){this.options[e]=t.wq_trim();return this.formatter=WebSquare.format.createFormatter("text","","","","","",this.scope_id,this.id),"allowChar"===e?this.formatter.setAllowChar(this.options.allowChar):"ignoreChar"===e&&this.formatter.setIgnoreChar(this.options.ignoreChar),this.validator=new WebSquare.validator.validateInvoker(this.id,this.options),!0}}catch(e){n.Y.printStackTrace(e)}},u.prototype._setValueNotInList=function(e,t){try{switch(this.options.valueNotInList){case"keepValue":if(e)if(this.selectedIndex=-1,null!=this.dom.label.textContent)this.dom.label.textContent=e;else if(null!=this.dom.label.innerText)this.dom.label.innerText=e;else{var i=this._getLabel(e);this.dom.label.innerHTML=i}else this.options.emptyItem?this.setSelectedIndex(-1):this.setSelectedIndex(0);break;case"addItem":this.addItem(e,e),this.setValue(e);break;default:this.options.emptyItem?this.setSelectedIndex(-1,t):this.setSelectedIndex(0,t)}}catch(e){return n.Y.printStackTrace(e,null,this),!1}}}}]);